<html><head><link rel="import" href="../polymer/polymer.html"><link rel="import" href="../iron-behaviors/iron-control-state.html"><link rel="import" href="../iron-flex-layout/iron-flex-layout.html"><link rel="import" href="../iron-validatable-behavior/iron-validatable-behavior.html"><link rel="import" href="../iron-form-element-behavior/iron-form-element-behavior.html"><link rel="prefetch" href="../polymer/polymer-mini.html"><link rel="prefetch" href="../polymer/polymer-micro.html"><link rel="prefetch" href="../iron-meta/iron-meta.html"></head><body><dom-module id="iron-autogrow-textarea"><template><style>:host{display:inline-block;position:relative;width:400px;border:1px solid;padding:2px;-moz-appearance:textarea;-webkit-appearance:textarea;overflow:hidden;}.mirror-text{visibility:hidden;word-wrap:break-word;}.fit{@apply (--layout-fit);}textarea{position:relative;outline:none;border:none;resize:none;background:inherit;color:inherit;width:100%;height:100%;font-size:inherit;font-family:inherit;line-height:inherit;text-align:inherit;@apply (--iron-autogrow-textarea);}::content textarea:invalid{box-shadow:none;}textarea::-webkit-input-placeholder{@apply (--iron-autogrow-textarea-placeholder);}textarea:-moz-placeholder{@apply (--iron-autogrow-textarea-placeholder);}textarea::-moz-placeholder{@apply (--iron-autogrow-textarea-placeholder);}textarea:-ms-input-placeholder{@apply (--iron-autogrow-textarea-placeholder);}</style><div id="mirror" class="mirror-text" aria-hidden="true">&nbsp;</div><div class="textarea-container fit"><textarea id="textarea" name$="[[name]]" autocomplete$="[[autocomplete]]" autofocus$="[[autofocus]]" inputmode$="[[inputmode]]" placeholder$="[[placeholder]]" readonly$="[[readonly]]" required$="[[required]]" disabled$="[[disabled]]" rows$="[[rows]]" minlength$="[[minlength]]" maxlength$="[[maxlength]]"></textarea></div></template></dom-module><script>Polymer({is:"iron-autogrow-textarea",behaviors:[Polymer.IronFormElementBehavior,Polymer.IronValidatableBehavior,Polymer.IronControlState],properties:{bindValue:{observer:"_bindValueChanged",type:String},rows:{type:Number,value:1,observer:"_updateCached"},maxRows:{type:Number,value:0,observer:"_updateCached"},autocomplete:{type:String,value:"off"},autofocus:{type:Boolean,value:!1},inputmode:{type:String},placeholder:{type:String},readonly:{type:String},required:{type:Boolean},minlength:{type:Number},maxlength:{type:Number}},listeners:{input:"_onInput"},observers:["_onValueChanged(value)"],get textarea(){return this.$.textarea},get selectionStart(){return this.$.textarea.selectionStart},get selectionEnd(){return this.$.textarea.selectionEnd},set selectionStart(value){this.$.textarea.selectionStart=value},set selectionEnd(value){this.$.textarea.selectionEnd=value},attached:function attached(){var IS_IOS=navigator.userAgent.match(/iP(?:[oa]d|hone)/);if(IS_IOS){this.$.textarea.style.marginLeft="-3px"}},validate:function validate(){if(!this.required&&""==this.value){this.invalid=!1;return!0}var valid;if(this.hasValidator()){valid=Polymer.IronValidatableBehavior.validate.call(this,this.value)}else{valid=this.$.textarea.validity.valid;this.invalid=!valid}this.fire("iron-input-validate");return valid},_bindValueChanged:function _bindValueChanged(){var textarea=this.textarea;if(!textarea){return}if(textarea.value!==this.bindValue){textarea.value=!(this.bindValue||0===this.bindValue)?"":this.bindValue}this.value=this.bindValue;this.$.mirror.innerHTML=this._valueForMirror();this.fire("bind-value-changed",{value:this.bindValue})},_onInput:function _onInput(event){this.bindValue=event.path?event.path[0].value:event.target.value},_constrain:function _constrain(tokens){var _tokens;tokens=tokens||[""];if(0<this.maxRows&&tokens.length>this.maxRows){_tokens=tokens.slice(0,this.maxRows)}else{_tokens=tokens.slice(0)}while(0<this.rows&&_tokens.length<this.rows){_tokens.push("")}return _tokens.join("<br/>")+"&#160;"},_valueForMirror:function _valueForMirror(){var input=this.textarea;if(!input){return}this.tokens=input&&input.value?input.value.replace(/&/gm,"&amp;").replace(/"/gm,"&quot;").replace(/'/gm,"&#39;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").split("\n"):[""];return this._constrain(this.tokens)},_updateCached:function _updateCached(){this.$.mirror.innerHTML=this._constrain(this.tokens)},_onValueChanged:function _onValueChanged(){this.bindValue=this.value}});</script></body></html>