<html><head><link rel="import" href="../polymer/polymer.html"><link rel="import" href="../paper-input/paper-input.html"><link rel="import" href="../paper-card/paper-card.html"><link rel="import" href="../paper-styles/paper-styles.html"><link rel="import" href="../iron-list/iron-list.html"><link rel="import" href="../iron-ajax/iron-ajax.html"><link rel="import" href="../elmsln-loading/elmsln-loading.html"><link rel="import" href="../simple-colors/simple-colors.html"><link rel="import" href="hax-app-search-inputs.html"><link rel="import" href="hax-app-search-result.html"><link rel="prefetch" href="../polymer/polymer-mini.html"><link rel="prefetch" href="../polymer/polymer-micro.html"><link rel="prefetch" href="../iron-form-element-behavior/iron-form-element-behavior.html"><link rel="prefetch" href="../iron-input/iron-input.html"><link rel="prefetch" href="../iron-a11y-announcer/iron-a11y-announcer.html"><link rel="prefetch" href="../iron-validatable-behavior/iron-validatable-behavior.html"><link rel="prefetch" href="../iron-meta/iron-meta.html"><link rel="prefetch" href="../paper-input/paper-input-behavior.html"><link rel="prefetch" href="../iron-a11y-keys-behavior/iron-a11y-keys-behavior.html"><link rel="prefetch" href="../iron-behaviors/iron-control-state.html"><link rel="prefetch" href="../paper-input/paper-input-char-counter.html"><link rel="prefetch" href="../paper-styles/typography.html"><link rel="prefetch" href="../font-roboto/roboto.html"><link rel="prefetch" href="../paper-input/paper-input-addon-behavior.html"><link rel="prefetch" href="../paper-input/paper-input-container.html"><link rel="prefetch" href="../iron-flex-layout/iron-flex-layout.html"><link rel="prefetch" href="../paper-styles/default-theme.html"><link rel="prefetch" href="../paper-styles/color.html"><link rel="prefetch" href="../paper-input/paper-input-error.html"><link rel="prefetch" href="../iron-image/iron-image.html"><link rel="prefetch" href="../paper-styles/element-styles/paper-material-styles.html"><link rel="prefetch" href="../paper-styles/shadow.html"><link rel="prefetch" href="../iron-resizable-behavior/iron-resizable-behavior.html"><link rel="prefetch" href="../iron-scroll-target-behavior/iron-scroll-target-behavior.html"><link rel="prefetch" href="../iron-ajax/iron-request.html"><link rel="prefetch" href="../lrn-icons/lrn-icons.html"><link rel="prefetch" href="../iron-icon/iron-icon.html"><link rel="prefetch" href="../iron-iconset-svg/iron-iconset-svg.html"><link rel="prefetch" href="../materializecss-styles/colors.html"><link rel="prefetch" href="../simple-colors/simple-colors-utility.html"><link rel="prefetch" href="../paper-item/paper-item.html"><link rel="prefetch" href="../paper-item/paper-item-behavior.html"><link rel="prefetch" href="../iron-behaviors/iron-button-state.html"><link rel="prefetch" href="../paper-item/paper-item-shared-styles.html"><link rel="prefetch" href="../eco-json-schema-form/eco-json-schema-wizard.html"><link rel="prefetch" href="../iron-flex-layout/iron-flex-layout-classes.html"><link rel="prefetch" href="../iron-icons/image-icons.html"><link rel="prefetch" href="../iron-icons/iron-icons.html"><link rel="prefetch" href="../iron-icons/editor-icons.html"><link rel="prefetch" href="../iron-pages/iron-pages.html"><link rel="prefetch" href="../iron-selector/iron-selectable.html"><link rel="prefetch" href="../iron-selector/iron-selection.html"><link rel="prefetch" href="../paper-icon-button/paper-icon-button.html"><link rel="prefetch" href="../paper-behaviors/paper-inky-focus-behavior.html"><link rel="prefetch" href="../paper-behaviors/paper-ripple-behavior.html"><link rel="prefetch" href="../paper-ripple/paper-ripple.html"><link rel="prefetch" href="../paper-toolbar/paper-toolbar.html"><link rel="prefetch" href="../paper-menu-button/paper-menu-button.html"><link rel="prefetch" href="../iron-dropdown/iron-dropdown.html"><link rel="prefetch" href="../iron-overlay-behavior/iron-overlay-behavior.html"><link rel="prefetch" href="../iron-fit-behavior/iron-fit-behavior.html"><link rel="prefetch" href="../iron-overlay-behavior/iron-overlay-manager.html"><link rel="prefetch" href="../iron-overlay-behavior/iron-overlay-backdrop.html"><link rel="prefetch" href="../iron-overlay-behavior/iron-scroll-manager.html"><link rel="prefetch" href="../iron-overlay-behavior/iron-focusables-helper.html"><link rel="prefetch" href="../neon-animation/neon-animation-runner-behavior.html"><link rel="prefetch" href="../neon-animation/neon-animatable-behavior.html"><link rel="prefetch" href="../iron-dropdown/iron-dropdown-scroll-manager.html"><link rel="prefetch" href="../neon-animation/animations/fade-in-animation.html"><link rel="prefetch" href="../neon-animation/neon-animation-behavior.html"><link rel="prefetch" href="../neon-animation/animations/fade-out-animation.html"><link rel="prefetch" href="../paper-menu-button/paper-menu-button-animations.html"><link rel="prefetch" href="../app-localize-behavior/app-localize-behavior.html"><link rel="prefetch" href="../intl-messageformat/dist/intl-messageformat.min.js"><link rel="prefetch" href="../eco-json-schema-form/eco-json-schema-object.html"><link rel="prefetch" href="../eco-json-schema-form/eco-json-schema-array.html"><link rel="prefetch" href="../paper-collapse-item/paper-collapse-item.html"><link rel="prefetch" href="../iron-collapse/iron-collapse.html"><link rel="prefetch" href="../paper-item/paper-item-body.html"><link rel="prefetch" href="../paper-collapse-item/simple-paper-item.html"><link rel="prefetch" href="../paper-collapse-item/paper-collapse-group.html"><link rel="prefetch" href="../eco-json-schema-form/eco-json-schema-boolean.html"><link rel="prefetch" href="../paper-checkbox/paper-checkbox.html"><link rel="prefetch" href="../paper-behaviors/paper-checked-element-behavior.html"><link rel="prefetch" href="../iron-checked-element-behavior/iron-checked-element-behavior.html"><link rel="prefetch" href="../eco-json-schema-form/eco-json-schema-enum.html"><link rel="prefetch" href="../paper-dropdown-menu/paper-dropdown-menu.html"><link rel="prefetch" href="../paper-dropdown-menu/paper-dropdown-menu-icons.html"><link rel="prefetch" href="../paper-dropdown-menu/paper-dropdown-menu-shared-styles.html"><link rel="prefetch" href="../paper-menu/paper-menu.html"><link rel="prefetch" href="../iron-menu-behavior/iron-menu-behavior.html"><link rel="prefetch" href="../iron-selector/iron-multi-selectable.html"><link rel="prefetch" href="../paper-menu/paper-menu-shared-styles.html"><link rel="prefetch" href="../eco-json-schema-form/eco-json-schema-input.html"><link rel="prefetch" href="../eco-json-schema-form/eco-json-schema-file.html"><link rel="prefetch" href="../paper-button/paper-button.html"><link rel="prefetch" href="../paper-behaviors/paper-button-behavior.html"><link rel="prefetch" href="../eco-json-schema-form/eco-json-schema-geolocation.html"><link rel="prefetch" href="../iron-icons/communication-icons.html"><link rel="prefetch" href="../geo-location/geo-location.html"><link rel="prefetch" href="../google-map/google-map.html"><link rel="prefetch" href="../google-apis/google-maps-api.html"><link rel="prefetch" href="../iron-jsonp-library/iron-jsonp-library.html"><link rel="prefetch" href="../iron-selector/iron-selector.html"><link rel="prefetch" href="../google-map/google-map-marker.html"></head><body><dom-module id="hax-app-search"><template><style is="custom-style">:host{display:block;}paper-button.item-wrapper{margin:0;padding:0;}paper-card{padding:0;margin:8px;width:240px;font-size:12px;--paper-card-header:{max-height:160px;};}@media screen and (min-width: 800px){paper-card{font-size:14px;}}#loading[hidden]{visibility:hidden !important;opacity:0 !important;display:block !important;}.loading{width:calc(100% - 32px);z-index:1000;opacity:.9;text-align:center;align-content:space-around;justify-content:center;position:absolute;padding:0;margin:0;display:flex;margin:0 auto;visibility:visible;transition:visibility .5s, opacity .5s ease;}.loading elmsln-loading{margin:0 5em;display:inline-flex;}#loading{height:100%;display:flex;justify-content:center;}#loading .loading,
      #loading elmsln-loading{display:block;height:5em;}.card-content{padding:.1em;}.card-content p{padding:0;margin:0;}#itemlist{min-height:150px;border:1px solid #222222;}hax-app-search-inputs{min-height:150px;padding:16px 16px 0 16px;color:#222222;}hax-app-pagination{min-height:32px;font-size:.8em;display:none;justify-content:flex-end;justify-content:center;color:#222222;}.loading-text{font-size:32px;padding:16px 0;color:var(--simple-colors-light-green-background3);}</style><iron-ajax auto="[[auto]]" id="request" method="[[method]]" url="[[requestEndPoint]]" handle-as="json" headers="[[headers]]" params="[[requestParams]]" last-response="{{requestData}}" hidden="" loading="{{loading}}" debounce-duration="250"></iron-ajax><hax-app-search-inputs label="[[label]]" schema="{{searchSchema}}" values="{{searchValues}}"></hax-app-search-inputs><hax-app-pagination id="pagerbottom" request-data="[[requestData]]" pagination="[[pagination]]"></hax-app-pagination><div id="loading" class="loading" hidden$="[[!loading]]"><elmsln-loading color="light-green-text text-accent-3" size="large"></elmsln-loading><div class="loading-text">Loading content..</div></div><iron-list grid="" id="itemlist" items="[[media]]" as="resultData"><template><hax-app-search-result result-data="[[resultData]]"></hax-app-search-result></template></iron-list></template><script>Polymer({is:"hax-app-search",properties:{activeApp:{type:Object,observer:"_resetAppSearch"},auto:{type:Boolean,value:!1},searchSchema:{type:Object,value:{}},searchValues:{type:Object,value:{}},headers:{type:Object,value:{}},method:{type:String,value:"GET"},loading:{type:Boolean,value:!1},requestData:{type:Object,value:{},observer:"_requestDataChanged"},media:{type:Array,value:[],observer:"_mediaChanged"}},_searchValuesEvent:function _searchValuesEvent(e){if(babelHelpers.typeof(e.detail)!=="undefined"){var requestParams=this.requestParams;for(var property in e.detail){requestParams[property]=e.detail[property]}this.set("requestParams",{});this.set("requestParams",requestParams)}},_resetAppSearch:function _resetAppSearch(newValue){if(babelHelpers.typeof(newValue)!=="undefined"&&null!==newValue){var app=newValue,requestParams={};this.label=app.details.title;this.auto=!1;this.set("media",[]);if(babelHelpers.typeof(app.connection.data)!=="undefined"){requestParams=app.connection.data}if(babelHelpers.typeof(app.connection.operations.browse.data)!=="undefined"){requestParams=Object.assign(requestParams,app.connection.operations.browse.data)}this.set("method",app.connection.operations.browse.method);this.set("headers",{});if(babelHelpers.typeof(app.connection.headers)!=="undefined"){this.set("headers",app.connection.headers)}this.set("requestParams",{});this.set("requestParams",requestParams);var requestEndPoint=app.connection.protocol+"://"+app.connection.url;if("/"!=requestEndPoint.substr(requestEndPoint.length-1)){requestEndPoint+="/"}if(babelHelpers.typeof(app.connection.operations.browse.endPoint)!=="undefined"){requestEndPoint+=app.connection.operations.browse.endPoint}this.set("requestEndPoint",requestEndPoint);this.set("searchSchema",{});var searchSchema={properties:{}};if(babelHelpers.typeof(app.connection.operations.browse.search)!=="undefined"){searchSchema.properties=app.connection.operations.browse.search;this.set("searchSchema",searchSchema)}this.resultMap=app.connection.operations.browse.resultMap;this.set("pagination",{});if(babelHelpers.typeof(app.connection.operations.browse.pagination)!=="undefined"){this.set("pagination",app.connection.operations.browse.pagination)}if(babelHelpers.typeof(app.connection.auto)!=="undefined"){this.auto=app.connection.auto}else{this.auto=!0}}},attached:function attached(){document.body.addEventListener("hax-store-property-updated",this._haxStorePropertyUpdated.bind(this));document.body.addEventListener("hax-app-search-values-changed",this._searchValuesEvent.bind(this))},detached:function detached(){document.body.removeEventListener("hax-store-property-updated",this._haxStorePropertyUpdated.bind(this));document.body.removeEventListener("hax-app-search-values-changed",this._searchValuesEvent.bind(this))},_haxStorePropertyUpdated:function _haxStorePropertyUpdated(e){if(e.detail&&babelHelpers.typeof(e.detail.value)!=="undefined"&&e.detail.property){this.set(e.detail.property,e.detail.value)}},_requestDataChanged:function _requestDataChanged(newValue,oldValue){if({}!=babelHelpers.typeof(newValue)&&babelHelpers.typeof(oldValue)!=="undefined"){var media=[],map=this.resultMap,data=[];if(babelHelpers.typeof(this._resolveObjectPath(map.items,newValue))!=="undefined"){data=this._resolveObjectPath(map.items,newValue)}else{if(null!=newValue){data=newValue}}if(null!=data){for(i=0;i<data.length;i++){media[i]={title:this._resolveObjectPath(map.preview.title,data[i]),details:this._resolveObjectPath(map.preview.details,data[i]),type:map.defaultGizmoType,map:{}};if(babelHelpers.typeof(media[i].details)!=="undefined"&&null!=media[i].details){media[i].details=media[i].details.replace(/(<([^>]+)>)/ig,"")}if(map.preview.id.constructor===Object){var tmp=this._resolveObjectPath(map.preview.id.property,data[i]);if("split"===map.preview.id.op){tmp=tmp.split(map.preview.id.delimiter);media[i].id=tmp[map.preview.id.position]}}else{media[i].id=this._resolveObjectPath(map.preview.id,data[i])}if(babelHelpers.typeof(map.preview.image)!=="undefined"){media[i].image=this._resolveObjectPath(map.preview.image,data[i])}else if(babelHelpers.typeof(map.image)!=="undefined"){media[i].image=map.image}else{media[i].image=""}for(var prop in map.gizmo){if("_url_source"===prop){var _id="";if(babelHelpers.typeof(media[i].map.__id)!=="undefined"){_id=media[i].map.__id}else{_id=this._resolveObjectPath(map.gizmo.id,data[i])}media[i].map.source=map.gizmo._url_source.replace("<%= id %>",_id)}else{if(map.gizmo[prop].constructor===Object){var _tmp=this._resolveObjectPath(map.gizmo[prop].property,data[i]);if("split"===map.gizmo[prop].op){_tmp=_tmp.split(map.gizmo[prop].delimiter);media[i].map[prop]=_tmp[map.gizmo[prop].position];if("id"===prop){media[i].map.__id=media[i].map[prop]}}}else{media[i].map[prop]=this._resolveObjectPath(map.gizmo[prop],data[i])}}}if(babelHelpers.typeof(media[i].map.url)==="undefined"&&babelHelpers.typeof(media[i].map.source)!=="undefined"){media[i].map.url=media[i].map.source}if(babelHelpers.typeof(map.gizmo.type)!=="undefined"){media[i].type=this._resolveObjectPath(map.gizmo.type,data[i])}}this.set("media",[]);this.set("media",media)}}},_mediaChanged:function _mediaChanged(newValue,oldValue){var _this=this;if(babelHelpers.typeof(oldValue)!=="undefined"){setTimeout(function(){_this.$.itemlist.fire("iron-resize")},200)}},_resolveObjectPath:function _resolveObjectPath(path,obj){return path.split(".").reduce(function(prev,curr){return prev?prev[curr]:null},obj||self)}});</script></dom-module></body></html>