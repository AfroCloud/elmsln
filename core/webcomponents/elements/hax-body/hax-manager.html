<html><head><link rel="import" href="../polymer/polymer.html"><link rel="import" href="../app-layout/app-drawer/app-drawer.html"><link rel="import" href="../paper-input/paper-input.html"><link rel="import" href="../paper-button/paper-button.html"><link rel="import" href="../paper-icon-button/paper-icon-button.html"><link rel="import" href="../iron-pages/iron-pages.html"><link rel="import" href="../iron-icons/iron-icons.html"><link rel="import" href="../simple-colors/simple-colors.html"><link rel="import" href="../vaadin-upload/vaadin-upload.html"><link rel="import" href="../materializecss-styles/materializecss-styles.html"><link rel="import" href="hax-preview.html"><link rel="import" href="hax-app-browser.html"><link rel="import" href="hax-gizmo-browser.html"><link rel="prefetch" href="../polymer/polymer-mini.html"><link rel="prefetch" href="../polymer/polymer-micro.html"><link rel="prefetch" href="../iron-flex-layout/iron-flex-layout.html"><link rel="prefetch" href="../iron-form-element-behavior/iron-form-element-behavior.html"><link rel="prefetch" href="../iron-input/iron-input.html"><link rel="prefetch" href="../iron-a11y-announcer/iron-a11y-announcer.html"><link rel="prefetch" href="../iron-validatable-behavior/iron-validatable-behavior.html"><link rel="prefetch" href="../iron-meta/iron-meta.html"><link rel="prefetch" href="../paper-input/paper-input-behavior.html"><link rel="prefetch" href="../iron-a11y-keys-behavior/iron-a11y-keys-behavior.html"><link rel="prefetch" href="../iron-behaviors/iron-control-state.html"><link rel="prefetch" href="../paper-input/paper-input-char-counter.html"><link rel="prefetch" href="../paper-styles/typography.html"><link rel="prefetch" href="../font-roboto/roboto.html"><link rel="prefetch" href="../paper-input/paper-input-addon-behavior.html"><link rel="prefetch" href="../paper-input/paper-input-container.html"><link rel="prefetch" href="../paper-styles/default-theme.html"><link rel="prefetch" href="../paper-styles/color.html"><link rel="prefetch" href="../paper-input/paper-input-error.html"><link rel="prefetch" href="../paper-behaviors/paper-button-behavior.html"><link rel="prefetch" href="../iron-behaviors/iron-button-state.html"><link rel="prefetch" href="../paper-behaviors/paper-ripple-behavior.html"><link rel="prefetch" href="../paper-ripple/paper-ripple.html"><link rel="prefetch" href="../paper-styles/element-styles/paper-material-styles.html"><link rel="prefetch" href="../paper-styles/shadow.html"><link rel="prefetch" href="../iron-icon/iron-icon.html"><link rel="prefetch" href="../paper-behaviors/paper-inky-focus-behavior.html"><link rel="prefetch" href="../iron-resizable-behavior/iron-resizable-behavior.html"><link rel="prefetch" href="../iron-selector/iron-selectable.html"><link rel="prefetch" href="../iron-selector/iron-selection.html"><link rel="prefetch" href="../iron-iconset-svg/iron-iconset-svg.html"><link rel="prefetch" href="../simple-colors/simple-colors-utility.html"><link rel="prefetch" href="../vaadin-upload/vaadin-upload-icons.html"><link rel="prefetch" href="../vaadin-upload/vaadin-upload-file.html"><link rel="prefetch" href="../paper-progress/paper-progress.html"><link rel="prefetch" href="../iron-range-behavior/iron-range-behavior.html"><link rel="prefetch" href="../materializecss-styles/colors.html"><link rel="prefetch" href="../materializecss-styles/shapes.html"><link rel="prefetch" href="../eco-json-schema-form/eco-json-schema-wizard.html"><link rel="prefetch" href="../iron-flex-layout/iron-flex-layout-classes.html"><link rel="prefetch" href="../iron-icons/image-icons.html"><link rel="prefetch" href="../iron-icons/editor-icons.html"><link rel="prefetch" href="../paper-toolbar/paper-toolbar.html"><link rel="prefetch" href="../paper-menu-button/paper-menu-button.html"><link rel="prefetch" href="../iron-dropdown/iron-dropdown.html"><link rel="prefetch" href="../iron-overlay-behavior/iron-overlay-behavior.html"><link rel="prefetch" href="../iron-fit-behavior/iron-fit-behavior.html"><link rel="prefetch" href="../iron-overlay-behavior/iron-overlay-manager.html"><link rel="prefetch" href="../iron-overlay-behavior/iron-overlay-backdrop.html"><link rel="prefetch" href="../iron-overlay-behavior/iron-scroll-manager.html"><link rel="prefetch" href="../iron-overlay-behavior/iron-focusables-helper.html"><link rel="prefetch" href="../neon-animation/neon-animation-runner-behavior.html"><link rel="prefetch" href="../neon-animation/neon-animatable-behavior.html"><link rel="prefetch" href="../iron-dropdown/iron-dropdown-scroll-manager.html"><link rel="prefetch" href="../neon-animation/animations/fade-in-animation.html"><link rel="prefetch" href="../neon-animation/neon-animation-behavior.html"><link rel="prefetch" href="../neon-animation/animations/fade-out-animation.html"><link rel="prefetch" href="../paper-menu-button/paper-menu-button-animations.html"><link rel="prefetch" href="../app-localize-behavior/app-localize-behavior.html"><link rel="prefetch" href="../iron-ajax/iron-ajax.html"><link rel="prefetch" href="../iron-ajax/iron-request.html"><link rel="prefetch" href="../intl-messageformat/dist/intl-messageformat.min.js"><link rel="prefetch" href="../eco-json-schema-form/eco-json-schema-object.html"><link rel="prefetch" href="../eco-json-schema-form/eco-json-schema-array.html"><link rel="prefetch" href="../paper-collapse-item/paper-collapse-item.html"><link rel="prefetch" href="../iron-collapse/iron-collapse.html"><link rel="prefetch" href="../paper-item/paper-item-body.html"><link rel="prefetch" href="../paper-styles/paper-styles.html"><link rel="prefetch" href="../paper-collapse-item/simple-paper-item.html"><link rel="prefetch" href="../paper-item/paper-item-behavior.html"><link rel="prefetch" href="../paper-item/paper-item-shared-styles.html"><link rel="prefetch" href="../paper-collapse-item/paper-collapse-group.html"><link rel="prefetch" href="../eco-json-schema-form/eco-json-schema-boolean.html"><link rel="prefetch" href="../paper-checkbox/paper-checkbox.html"><link rel="prefetch" href="../paper-behaviors/paper-checked-element-behavior.html"><link rel="prefetch" href="../iron-checked-element-behavior/iron-checked-element-behavior.html"><link rel="prefetch" href="../eco-json-schema-form/eco-json-schema-enum.html"><link rel="prefetch" href="../paper-dropdown-menu/paper-dropdown-menu.html"><link rel="prefetch" href="../paper-dropdown-menu/paper-dropdown-menu-icons.html"><link rel="prefetch" href="../paper-dropdown-menu/paper-dropdown-menu-shared-styles.html"><link rel="prefetch" href="../paper-menu/paper-menu.html"><link rel="prefetch" href="../iron-menu-behavior/iron-menu-behavior.html"><link rel="prefetch" href="../iron-selector/iron-multi-selectable.html"><link rel="prefetch" href="../paper-menu/paper-menu-shared-styles.html"><link rel="prefetch" href="../paper-item/paper-item.html"><link rel="prefetch" href="../eco-json-schema-form/eco-json-schema-input.html"><link rel="prefetch" href="../eco-json-schema-form/eco-json-schema-file.html"><link rel="prefetch" href="../eco-json-schema-form/eco-json-schema-geolocation.html"><link rel="prefetch" href="../iron-icons/communication-icons.html"><link rel="prefetch" href="../geo-location/geo-location.html"><link rel="prefetch" href="../google-map/google-map.html"><link rel="prefetch" href="../google-apis/google-maps-api.html"><link rel="prefetch" href="../iron-jsonp-library/iron-jsonp-library.html"><link rel="prefetch" href="../iron-selector/iron-selector.html"><link rel="prefetch" href="../google-map/google-map-marker.html"><link rel="prefetch" href="../paper-toggle-button/paper-toggle-button.html"><link rel="prefetch" href="../paper-card/paper-card.html"><link rel="prefetch" href="../iron-image/iron-image.html"><link rel="prefetch" href="../paper-input/paper-textarea.html"><link rel="prefetch" href="../iron-autogrow-textarea/iron-autogrow-textarea.html"><link rel="prefetch" href="../code-editor/code-editor.html"><link rel="prefetch" href="../hax-body-behaviors/hax-body-behaviors.html"><link rel="prefetch" href="../schema-behaviors/schema-behaviors.html"><link rel="prefetch" href="../juicy-ace-editor/juicy-ace-editor.html"><link rel="prefetch" href="../ace-builds/src-min-noconflict/ace.js"><link rel="prefetch" href="../ace-builds/src-min-noconflict/ext-searchbox.js"><link rel="prefetch" href="../code-editor/code-pen-button.html"><link rel="prefetch" href="../app-datepicker/app-datepicker.html"><link rel="prefetch" href="../app-datepicker/app-datepicker-icons.html"><link rel="prefetch" href="../app-datepicker/app-datepicker-animations.html"><link rel="prefetch" href="../neon-animation/web-animations.html"><link rel="prefetch" href="../web-animations-js/web-animations-next-lite.min.js"><link rel="prefetch" href="../iron-list/iron-list.html"><link rel="prefetch" href="../iron-scroll-target-behavior/iron-scroll-target-behavior.html"><link rel="prefetch" href="../neon-animation/neon-animated-pages.html"><link rel="prefetch" href="../neon-animation/animations/slide-from-left-animation.html"><link rel="prefetch" href="../neon-animation/animations/slide-from-right-animation.html"><link rel="prefetch" href="../paper-icon-picker/paper-icon-picker.html"><link rel="prefetch" href="../paper-listbox/paper-listbox.html"><link rel="prefetch" href="../iron-a11y-keys/iron-a11y-keys.html"><link rel="prefetch" href="../paper-tooltip/paper-tooltip.html"><link rel="prefetch" href="../paper-icon-picker/paper-icon-picker-icon.html"><link rel="prefetch" href="../paper-input-flagged/paper-input-flagged.html"><link rel="prefetch" href="../vaadin-split-layout/vaadin-split-layout.html"><link rel="prefetch" href="../grafitto-filter/grafitto-filter.html"><link rel="prefetch" href="../dropdown-select/dropdown-select.html"><link rel="prefetch" href="hax-app-browser-item.html"><link rel="prefetch" href="../iron-icons/device-icons.html"><link rel="prefetch" href="../iron-icons/hardware-icons.html"><link rel="prefetch" href="../iron-icons/social-icons.html"><link rel="prefetch" href="../iron-icons/av-icons.html"><link rel="prefetch" href="../iron-icons/places-icons.html"><link rel="prefetch" href="../iron-icons/maps-icons.html"><link rel="prefetch" href="hax-app-search.html"><link rel="prefetch" href="../elmsln-loading/elmsln-loading.html"><link rel="prefetch" href="../lrn-icons/lrn-icons.html"><link rel="prefetch" href="hax-app-search-inputs.html"><link rel="prefetch" href="hax-app-search-result.html"><link rel="prefetch" href="hax-gizmo-browser-item.html"></head><body><dom-module id="hax-manager"><template><style is="custom-style" include="materializecss-styles">:host{display:block;--hax-manager-steps-color:#FFFFFF;--hax-manager-ink-color:#FFFFFF;--hax-accent:var(--simple-colors-light-green-background1);color:#FFFFFF;}#dialog{color:#FFFFFF;z-index:10000;padding:56px 0;margin-top:64px;--app-drawer-width:400px;--app-drawer-content-container:{background-color:rgba(0, 0, 0, 0.7);};}paper-icon-button#closedialog{float:right;top:135px;right:0;position:absolute;padding:4px;margin:0;color:var(--simple-colors-light-green-background1);}:host[active-page="0"] #dialog{--app-drawer-width:400px;}:host[active-page="1"] #dialog{--app-drawer-width:800px;}:host[active-page="2"] #dialog{--app-drawer-width:800px;}:host[active-step] #dialog{--app-drawer-width:1000px;}:host[searching] #dialog{--app-drawer-width:1000px;}.title{text-align:center;padding:16px;margin:0;background-color:rgba(0, 0, 0, 0.5);font-size:32px;font-weight:bold;font-family:sans-serif;text-transform:uppercase;color:var(--simple-colors-light-green-background1);}#activepage{}#preview{height:100%;}vaadin-upload{--primary-color:var(--hax-accent);--primary-font-color:#FFFFFF;--dark-primary-color:#FFFFFF;--light-primary-color:var(--hax-accent);--error-color:darkred;color:#FFFFFF;display:block;padding:32px !important;--vaadin-upload-button-add-wrapper:{border:2px solid #FFFFFF;background-color:var(--hax-accent);color:#FFFFFF;display:block;};--vaadin-upload-buttons-primary:{display:block;width:100%;flex:unset;-webkit-flex:unset;};--vaadin-upload-button-add:{color:#000000;display:block;flex:unset;-webkit-flex:unset;text-align:center;};--vaadin-upload-drop-label:{color:#FFFFFF;display:block;padding:16px;};--vaadin-upload-drop-label-dragover:{color:#FFFFFF;};--vaadin-upload-file-list:{padding:16px;margin:0;color:#FFFFFF;};--vaadin-upload-file:{color:#FFFFFF;};}vaadin-upload[dragover]{border-color:#396;}vaadin-upload-file{--disabled-text-color:#222222;}.add-area-content-wrapper{padding:0 16px;}.add-url-are,
      .add-upload-area{margin:16px 0;}.url-description{font-size:18px;color:#FFFFFF;line-height:22px;font-family:sans-serif;letter-spacing:1px;}#steppages{height:100%;}#newassetconfigure{width:100%;margin:0;padding:16px;background-color:var(--simple-colors-light-green-background1);color:#000000;}paper-input{color:#FFFFFF;--paper-input-container-invalid-color:var(--simple-colors-red-foreground3);--secondary-text-color:#FFFFFF;--primary-text-color:#FFFFFF;--paper-input-container-input-color:#FFFFFF;--paper-input-container-color:#FFFFFF;--paper-input-container-focus-color:var(--simple-colors-light-green-background1);}@media screen and (max-width: 550px){.hide-on-mobile{opacity:0;visibility:hidden;position:absolute;left:-9999px;}.page-area.hax-manager{padding:6px;}}</style><app-drawer id="dialog" opened="{{opened}}" disable-swipe=""><div class="dialog-contents" id="dialogcontent" style="height: 100%; overflow: auto;"><iron-pages id="steppages" selected="{{activeStep}}" fallback-selection="select" role="main"><div data-value="select"><iron-pages id="activepage" selected="{{activePage}}" fallback-selection="link"><div class="page-area add-area"><h3 class="title">[[addTitle]]</h3><div class="add-area-content-wrapper"><div class="add-url-area"><paper-input id="url" label="URL" type="url" auto-validate=""></paper-input><div class="url-description">A full URL with https:// referencing a link that already exists on the web.</div></div><div class="add-upload-area"><vaadin-upload form-data-name="file-upload" id="fileupload" hidden$="[[!canSupportUploads]]"></vaadin-upload></div><paper-button id="newassetconfigure" raised="">Configure item</paper-button></div></div><div class="page-area"><hax-app-browser id="appbrowser"><slot></slot></hax-app-browser></div><div class="page-area"><hax-gizmo-browser id="gizmobrowser"></hax-gizmo-browser></div></iron-pages></div><div style="height:100%;"><hax-preview id="preview" element="{{activeHaxElement}}"></hax-preview></div></iron-pages><paper-icon-button id="closedialog" icon="icons:cancel" title="Close dialog"></paper-icon-button></div></app-drawer></template><script>Polymer({is:"hax-manager",listeners:{"dialog.iron-overlay-canceled":"close","dialog.iron-overlay-closed":"close","closedialog.tap":"close","newassetconfigure.tap":"newAssetConfigure","fileupload.upload-before":"_fileAboutToUpload","fileupload.upload-response":"_fileUploadResponse"},behaviors:[simpleColorsBehaviors],properties:{opened:{type:Boolean,value:!1,reflectToAttribute:!0,observer:"_openedChanged"},editExistingNode:{type:Boolean,value:!1},editTitle:{type:String,computed:"_computeEditTitle(editExistingNode)"},addTitle:{type:String,value:"Add content"},activeStep:{type:Boolean,reflectToAttribute:!0,value:!1,observer:"_activeStepChanged"},searching:{type:Boolean,reflectToAttribute:!0,value:!1},activePage:{type:String,reflectToAttribute:!0,value:0,observer:"_activePageChanged"},canSupportUploads:{type:Boolean,value:!1},activeHaxElement:{type:Object,observer:"_activeHaxElementChanged"},appList:{type:Array,value:[]},__allowUpload:{type:Boolean,value:!1},appendJwt:{type:String,value:null},appendUploadEndPoint:{type:String,value:null}},created:function created(){this.__attached=!1},attached:function attached(){if(!this.__attached){this.__attached=!0;document.body.appendChild(this)}this.fire("hax-register-manager",this);document.body.addEventListener("hax-store-property-updated",this._haxStorePropertyUpdated.bind(this));document.body.addEventListener("hax-app-picker-selection",this._haxAppPickerSelection.bind(this));document.body.addEventListener("place-holder-file-drop",this._placeHolderFileDrop.bind(this))},detached:function detached(){document.body.removeEventListener("hax-store-property-updated",this._haxStorePropertyUpdated.bind(this));document.body.removeEventListener("hax-app-picker-selection",this._haxAppPickerSelection.bind(this));document.body.removeEventListener("place-holder-file-drop",this._placeHolderFileDrop.bind(this))},togglePanelSize:function togglePanelSize(){this.$.dialog.classList.toggle("grow");this.updateStyles();window.dispatchEvent(new Event("resize"))},_computeEditTitle:function _computeEditTitle(updateExisting){if(babelHelpers.typeof(this.activeHaxElement)!=="undefined"&&updateExisting){return"Update"}else{return"Insert"}},_placeHolderFileDrop:function _placeHolderFileDrop(e){this.resetManager();this.open();Polymer.HaxStore.instance.activePlaceHolder=e.detail.placeHolderElement;this.$.fileupload._onDrop(e.detail)},_fileAboutToUpload:function _fileAboutToUpload(e){if(!this.__allowUpload){e.preventDefault();e.stopPropagation();var values={source:e.detail.file.name,type:e.detail.file.type},type=Polymer.HaxStore.guessGizmoType(values),targets=Polymer.HaxStore.getHaxAppStoreTargets(type);if(0!=targets.length){Polymer.HaxStore.instance.haxAppPicker.presentOptions(targets,type,"Where would you like to upload this "+type+"?","app")}else{Polymer.HaxStore.toast("Sorry, you don't have a storage location that can handle "+type+" uploads!",5e3)}}else{this.__allowUpload=!1}},_haxAppPickerSelection:function _haxAppPickerSelection(e){var connection=e.detail.connection;this.__appUsed=e.detail;this.$.fileupload.method=connection.operations.add.method;var requestEndPoint=connection.protocol+"://"+connection.url;if("/"!=requestEndPoint.substr(requestEndPoint.length-1)){requestEndPoint+="/"}if(babelHelpers.typeof(connection.operations.add.endPoint)!=="undefined"){requestEndPoint+=connection.operations.add.endPoint}if(null!=this.appendUploadEndPoint){requestEndPoint+="?"+this.appendUploadEndPoint}if(null!=this.appendJwt){requestEndPoint+="&"+this.appendJwt+"="+localStorage.getItem(this.appendJwt)}this.$.fileupload.headers=connection.headers;this.$.fileupload.target=requestEndPoint;this.__allowUpload=!0;this.$.fileupload.uploadFiles()},_fileUploadResponse:function _fileUploadResponse(e){var response=JSON.parse(e.detail.xhr.response),map=this.__appUsed.connection.operations.add.resultMap,data={},item={};if(babelHelpers.typeof(this._resolveObjectPath(map.item,response))!=="undefined"){data=this._resolveObjectPath(map.item,response)}item.type=map.defaultGizmoType;for(var prop in map.gizmo){item[prop]=this._resolveObjectPath(map.gizmo[prop],data)}if(babelHelpers.typeof(item.url)==="undefined"&&babelHelpers.typeof(item.source)!=="undefined"){item.url=item.source}if(babelHelpers.typeof(map.gizmo.type)!=="undefined"){item.type=this._resolveObjectPath(map.gizmo.type,data)}this.$.url.value=item.url;this.newAssetConfigure()},_activePageChanged:function _activePageChanged(newValue){if(babelHelpers.typeof(newValue)!=="undefined"){this.searching=!1;this.updateStyles();if(1===newValue){this.$.appbrowser.resetBrowser()}else if(2===newValue){this.$.gizmobrowser.resetBrowser()}}},_haxStorePropertyUpdated:function _haxStorePropertyUpdated(e){if(e.detail&&babelHelpers.typeof(e.detail.value)!=="undefined"&&e.detail.property){this.set(e.detail.property,e.detail.value)}},_activeHaxElementChanged:function _activeHaxElementChanged(newValue,oldValue){if(babelHelpers.typeof(oldValue)!=="undefined"){this.$.preview.advancedForm=!1;if(babelHelpers.typeof(newValue.tag)==="undefined"){this.resetManager()}else{this.$.fileupload.set("files",[]);this.$.dialog.scrollTop=0;this.selectStep("configure")}}},insertHaxElement:function insertHaxElement(){var previewNode=this.$.preview.previewNode,element=Polymer.HaxStore.nodeToHaxElement(previewNode);element.replace=this.editExistingNode;if(babelHelpers.typeof(this.activeHaxElement.__type)!=="undefined"){element.__type=this.activeHaxElement.__type}element.replacement=previewNode;this.fire("hax-insert-content",element);var toast="New element added!";if(this.editExistingNode){toast="Element updated!"}Polymer.HaxStore.toast(toast,2e3);this.close()},resetManager:function resetManager(){var activePage=0<arguments.length&&arguments[0]!==void 0?arguments[0]:0;this.selectStep("select");this.activePage=activePage;document.body.style.overflow=null;this.appList=Polymer.HaxStore.instance.appList;this.searching=!1;Polymer.HaxStore.write("activeApp",null,this);window.dispatchEvent(new Event("resize"));this.editExistingNode=!1;this.$.url.value="";this.$.fileupload.headers="";this.$.fileupload.method="";this.$.fileupload.target="";this.__allowUpload=!1},cancel:function cancel(){this.close()},_openedChanged:function _openedChanged(newValue,oldValue){if(oldValue&&!newValue){document.body.style.overflow=null}else if(newValue&&!oldValue){document.body.style.overflow="hidden"}},close:function close(e){var normalizedEvent=Polymer.dom(e),local=normalizedEvent.localTarget;if(babelHelpers.typeof(e)==="undefined"||local===this.$.dialog||local===this.$.closedialog){Polymer.HaxStore.write("activeHaxElement",{},this);this.opened=!1;this.resetManager()}},open:function open(){this.opened=!0},newAssetConfigure:function newAssetConfigure(){var values={source:this.$.url.value},type=Polymer.HaxStore.guessGizmoType(values),haxElements=Polymer.HaxStore.guessGizmo(type,values);if(0<haxElements.length){if(1===haxElements.length){if(babelHelpers.typeof(haxElements[0].tag)!=="undefined"){Polymer.HaxStore.write("activeHaxElement",haxElements[0],this)}}else{Polymer.HaxStore.instance.haxAppPicker.presentOptions(haxElements,type,"Pick how to present the "+type,"gizmo")}}else{Polymer.HaxStore.toast("Sorry, HAX doesn't know how to handle that type of link yet.")}},toggleDialog:function toggleDialog(){var toggle=0<arguments.length&&arguments[0]!==void 0?arguments[0]:!0;if(this.opened&&toggle){this.close()}else{Polymer.HaxStore.instance.closeAllDrawers(this)}},selectStep:function selectStep(step){if("configure"==step){this.activeStep=!0}else{this.activeStep=!1}},_activeStepChanged:function _activeStepChanged(newValue){if(newValue||!newValue){this.updateStyles();window.dispatchEvent(new Event("resize"))}},_resolveObjectPath:function _resolveObjectPath(path,obj){return path.split(".").reduce(function(prev,curr){return prev?prev[curr]:null},obj||self)}});</script></dom-module></body></html>