<html><head><link rel="import" href="../polymer/polymer.html"><link rel="import" href="vaadin-grid-column.html"><link rel="prefetch" href="../polymer/polymer-mini.html"><link rel="prefetch" href="../polymer/polymer-micro.html"><link rel="prefetch" href="vaadin-grid-templatizer.html"></head><body><dom-module id="vaadin-grid-selection-column"><template><template class="header" id="defaultHeaderTemplate"><input aria-label="Select All" hidden$="[[_selectAllHidden]]" type="checkbox" on-click="_onSelectAll" checked="[[_isChecked(selectAll, _indeterminate)]]" indeterminate="[[_indeterminate]]"></template><template id="defaultBodyTemplate"><input aria-label="Select Row" type="checkbox" checked="{{selected::change}}"></template></template><script>Polymer({is:"vaadin-grid-selection-column",behaviors:[vaadin.elements.grid.ColumnBehavior],properties:{width:{type:String,value:"52px"},flexGrow:{type:Number,value:0},selectAll:{type:Boolean,value:!1,notify:!0},autoSelect:{type:Boolean,value:!1},headerTemplate:Object,template:Object,_grid:Object,_indeterminate:Boolean,_previousActiveItem:Object,_selectAllHidden:Boolean},observers:["_onSelectAllChanged(selectAll, _grid)"],_prepareHeaderTemplate:function _prepareHeaderTemplate(){var headerTemplate=this._prepareTemplatizer(this._findTemplate("template.header")||this.$.defaultHeaderTemplate);headerTemplate.templatizer.dataHost=headerTemplate===this.$.defaultHeaderTemplate?this:this.dataHost;return headerTemplate},_prepareBodyTemplate:function _prepareBodyTemplate(){var template=this._prepareTemplatizer(this._findTemplate("template:not(.header):not(.footer)")||this.$.defaultBodyTemplate);template.templatizer.dataHost=template===this.$.defaultBodyTemplate?this:this.dataHost;return template},detached:function detached(){if(this._grid){this.unlisten(this._grid,"active-item-changed","_onActiveItemChanged");this.unlisten(this._grid,"data-provider-changed","_onDataProviderChanged");this.unlisten(this._grid,"filter-changed","_onSelectedItemsChanged");this.unlisten(this._grid,"selected-items-changed","_onSelectedItemsChanged");var isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);if(isSafari&&window.ShadyDOM&&this.parentElement){var parent=this.parentElement,nextSibling=this.nextElementSibling;parent.removeChild(this);if(nextSibling){parent.insertBefore(this,nextSibling)}else{parent.appendChild(this)}}}},attached:function attached(){this._grid=this._findGrid(this);if(this._grid){this.listen(this._grid,"active-item-changed","_onActiveItemChanged");this.listen(this._grid,"data-provider-changed","_onDataProviderChanged");this.listen(this._grid,"filter-changed","_onSelectedItemsChanged");this.listen(this._grid,"selected-items-changed","_onSelectedItemsChanged")}},_findGrid:function _findGrid(elm){while(elm&&"vaadin-grid"!=elm.localName){elm=Polymer.dom(elm).parentNode}return elm||void 0},_onSelectAllChanged:function _onSelectAllChanged(selectAll,grid){if(selectAll===void 0||grid===void 0){return}if(this._selectAllChangeLock){return}grid.selectedItems=selectAll&&grid.items?grid._filter(grid.items):[]},_arrayContains:function _arrayContains(a,b){for(var i=0;a&&b&&b[i]&&0<=a.indexOf(b[i]);i++){}return i==b.length},_onSelectAll:function _onSelectAll(){this.selectAll=this._indeterminate||!this.selectAll},_isChecked:function _isChecked(selectAll,indeterminate){return indeterminate||selectAll},_onActiveItemChanged:function _onActiveItemChanged(e){var activeItem=e.detail.value;if(this.autoSelect){var item=activeItem||this._previousActiveItem;if(item){this._grid._toggleItem(item)}}this._previousActiveItem=activeItem},_onSelectedItemsChanged:function _onSelectedItemsChanged(){this._selectAllChangeLock=!0;if(this._grid.items){if(!this._grid.selectedItems.length){this.selectAll=!1;this._indeterminate=!1}else if(this._arrayContains(this._grid.selectedItems,this._grid._filter(this._grid.items))){this.selectAll=!0;this._indeterminate=!1}else{this.selectAll=!1;this._indeterminate=!0}}this._selectAllChangeLock=!1},_onDataProviderChanged:function _onDataProviderChanged(){this._selectAllHidden=!this._grid.items}});</script></dom-module></body></html>