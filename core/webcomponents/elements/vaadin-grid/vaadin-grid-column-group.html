<html><head><link rel="import" href="../polymer/polymer.html"><link rel="import" href="vaadin-grid-column.html"><link rel="prefetch" href="../polymer/polymer-mini.html"><link rel="prefetch" href="../polymer/polymer-micro.html"><link rel="prefetch" href="vaadin-grid-templatizer.html"></head><body><dom-module id="vaadin-grid-column-group"><script>Polymer({is:"vaadin-grid-column-group",behaviors:[vaadin.elements.grid.ColumnBaseBehavior],properties:{_childColumns:{value:function value(){return this._getChildColumns(this)}},flexGrow:{type:Number,readOnly:!0},width:{type:String,readOnly:!0},_visibleChildColumns:Array,colSpan:{type:Number,notify:!0,readOnly:!0},_rootColumns:Array},observers:["_updateVisibleChildColumns(_childColumns)","_childColumnsChanged(_childColumns)","_flexGrowChanged(flexGrow)","_widthChanged(width)","_frozenChanged(_childColumns, frozen)","_hiddenChanged(hidden)","_visibleChildColumnsChanged(_visibleChildColumns)","_colSpanChanged(colSpan)","_orderChanged(_order, _rootColumns)","_reorderStatusChanged(_reorderStatus, _rootColumns)","_resizableChanged(resizable, _rootColumns)"],listeners:{"property-changed":"_columnPropChanged"},attached:function attached(){this._updateFlexAndWidth(this._visibleChildColumns);this._addNodeObserver()},detached:function detached(){if(this._observer){Polymer.dom(this).unobserveNodes(this._observer)}},_columnPropChanged:function _columnPropChanged(e){if("hidden"===e.detail.path){this._preventHiddenCascade=!0;this._updateVisibleChildColumns(this._childColumns);this._preventHiddenCascade=!1}if(/flexGrow|width|hidden|_childColumns/.test(e.detail.path)){this._updateFlexAndWidth(this._visibleChildColumns)}if("frozen"===e.detail.path){this.frozen=this.frozen||e.detail.value}if("lastFrozen"===e.detail.path){this._lastFrozen=this._lastFrozen||e.detail.value}},_orderChanged:function _orderChanged(order,rootColumns){var _Mathlog=Math.log;if(order&&rootColumns){var trailingZeros=/(0+)$/.exec(order).pop().length,childCountDigits=~~(_Mathlog(rootColumns.length)/_Mathlog(Math.LN10))+1,scope=Math.pow(10,trailingZeros-childCountDigits),_rootColumns=rootColumns.slice(0);if(_rootColumns[0]&&_rootColumns[0]._order){_rootColumns.sort(function(a,b){return a._order-b._order})}_rootColumns.forEach(function(column,index){column._order=order+(index+1)*scope});this.fire("property-changed",{path:"order",value:order})}},_reorderStatusChanged:function _reorderStatusChanged(reorderStatus,rootColumns){if(reorderStatus===void 0||rootColumns===void 0){return}rootColumns.forEach(function(column){column._reorderStatus=reorderStatus});this.fire("property-changed",{path:"reorderStatus",value:reorderStatus})},_resizableChanged:function _resizableChanged(resizable,rootColumns){if(resizable===void 0||rootColumns===void 0){return}rootColumns.forEach(function(column){column.resizable=resizable});this.fire("property-changed",{path:"resizable",value:resizable})},_updateVisibleChildColumns:function _updateVisibleChildColumns(childColumns){this._visibleChildColumns=Array.prototype.filter.call(childColumns,function(col){return!col.hidden})},_childColumnsChanged:function _childColumnsChanged(childColumns){if(!this._autoHidden&&this.hidden){Array.prototype.forEach.call(childColumns,function(column){column.hidden=!0});this._updateVisibleChildColumns(childColumns)}this.fire("property-changed",{path:"_childColumns",value:childColumns})},_updateFlexAndWidth:function _updateFlexAndWidth(visibleChildColumns){if(visibleChildColumns.length){this._setWidth("calc("+Array.prototype.reduce.call(visibleChildColumns,function(prev,curr){return prev+=" + "+(curr.width||"0px").replace("calc","")},"").substring(3)+")")}else{this._setWidth("0px")}this._setFlexGrow(Array.prototype.reduce.call(visibleChildColumns,function(prev,curr){return prev+curr.flexGrow},0))},_frozenChanged:function _frozenChanged(childColumns,frozen){if(childColumns===void 0||frozen===void 0){return}if(this._oldFrozen!==void 0||!1!==frozen){Array.prototype.forEach.call(childColumns,function(col){if("vaadin-grid-column-group"===col.localName){col.frozen=col.frozen||frozen}else{col.frozen=frozen}});this.fire("property-changed",{path:"frozen",value:frozen})}this._oldFrozen=frozen},_hiddenChanged:function _hiddenChanged(hidden){if(this._rootColumns&&!this._preventHiddenCascade){this._ignoreVisibleChildColumns=!0;this._rootColumns.forEach(function(column){column.hidden=hidden});this._ignoreVisibleChildColumns=!1}this.fire("property-changed",{path:"hidden",value:hidden})},_visibleChildColumnsChanged:function _visibleChildColumnsChanged(visibleChildColumns){this._setColSpan(visibleChildColumns.length);if(!this._ignoreVisibleChildColumns){if(0===visibleChildColumns.length){this._autoHidden=this.hidden=!0}else if(this.hidden&&this._autoHidden){this._autoHidden=this.hidden=!1}}},_colSpanChanged:function _colSpanChanged(colSpan){this.fire("property-changed",{path:"colSpan",value:colSpan})},_getChildColumns:function _getChildColumns(el){return Polymer.dom(el).queryDistributedElements("vaadin-grid-column, vaadin-grid-column-group, vaadin-grid-selection-column")},_addNodeObserver:function _addNodeObserver(){this._observer=Polymer.dom(this).observeNodes(function(info){var isColumnElement=function(node){return node.nodeType===Node.ELEMENT_NODE&&/^vaadin-grid-(column|selection)/i.test(node.localName)};if(0<info.addedNodes.filter(isColumnElement).length||0<info.removedNodes.filter(isColumnElement).length){this._rootColumns=this._getChildColumns(this);this._childColumns=this._rootColumns}}.bind(this))}});</script></dom-module></body></html>