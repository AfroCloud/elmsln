<html><head><link rel="import" href="../polymer/polymer.html"><link rel="import" href="../iron-scroll-target-behavior/iron-scroll-target-behavior.html"><script>window.vaadin=window.vaadin||{};vaadin.elements=vaadin.elements||{};vaadin.elements.grid=vaadin.elements.grid||{};vaadin.elements.grid.IronListBehaviorImpl=function(){var _Mathabs=Math.abs,_Mathround=Math.round,_Mathceil=Math.ceil,_Mathfloor=Math.floor,_Mathmin=Math.min,_Mathmax=Math.max,IOS=navigator.userAgent.match(/iP(?:hone|ad;(?: U;)? CPU) OS (\d+)/),IOS_TOUCH_SCROLLING=IOS&&8<=IOS[1];return{is:"iron-list",properties:{maxPhysicalCount:{type:Number,value:500},as:{type:String,value:"item"},indexAs:{type:String,value:"index"}},_ratio:.5,_scrollerPaddingTop:0,_scrollPosition:0,_physicalSize:0,_physicalAverage:0,_physicalAverageCount:0,_physicalTop:0,_virtualCount:0,_physicalIndexForKey:null,_estScrollHeight:0,_scrollHeight:0,_viewportHeight:0,_viewportWidth:0,_physicalItems:null,_physicalSizes:null,_firstVisibleIndexVal:null,_lastVisibleIndexVal:null,_collection:null,_itemsRendered:!1,_lastPage:null,_maxPages:3,_itemsPerRow:1,_itemWidth:0,_rowHeight:0,get _physicalBottom(){return this._physicalTop+this._physicalSize},get _scrollBottom(){return this._scrollPosition+this._viewportHeight},get _virtualEnd(){return this._virtualStart+this._physicalCount-1},get _hiddenContentSize(){return this._physicalSize-this._viewportHeight},get _maxScrollTop(){return this._estScrollHeight-this._viewportHeight+this._scrollerPaddingTop},_minVirtualStart:0,get _maxVirtualStart(){return _Mathmax(0,this._virtualCount-this._physicalCount)},_virtualStartVal:0,set _virtualStart(val){this._virtualStartVal=_Mathmin(this._maxVirtualStart,_Mathmax(this._minVirtualStart,val))},get _virtualStart(){return this._virtualStartVal||0},_physicalStartVal:0,set _physicalStart(val){this._physicalStartVal=val%this._physicalCount;if(0>this._physicalStartVal){this._physicalStartVal=this._physicalCount+this._physicalStartVal}this._physicalEnd=(this._physicalStart+this._physicalCount-1)%this._physicalCount},get _physicalStart(){return this._physicalStartVal||0},_physicalCountVal:0,set _physicalCount(val){this._physicalCountVal=val;this._physicalEnd=(this._physicalStart+this._physicalCount-1)%this._physicalCount},get _physicalCount(){return this._physicalCountVal},_physicalEnd:0,get _optPhysicalSize(){return this._viewportHeight*this._maxPages},get _optPhysicalCount(){return this._estRowsInView*this._itemsPerRow*this._maxPages},get _isVisible(){return this.scrollTarget&&!!(this.scrollTarget.offsetWidth||this.scrollTarget.offsetHeight)},get firstVisibleIndex(){if(null===this._firstVisibleIndexVal){var physicalOffset=_Mathfloor(this._physicalTop+this._scrollerPaddingTop);this._firstVisibleIndexVal=this._iterateItems(function(pidx,vidx){physicalOffset+=this._getPhysicalSizeIncrement(pidx);if(physicalOffset>this._scrollPosition){return vidx}})||0}return this._firstVisibleIndexVal},get lastVisibleIndex(){if(null===this._lastVisibleIndexVal){var physicalOffset=this._physicalTop;this._iterateItems(function(pidx,vidx){if(physicalOffset<this._scrollBottom){this._lastVisibleIndexVal=vidx}else{return!0}physicalOffset+=this._getPhysicalSizeIncrement(pidx)})}return this._lastVisibleIndexVal},get _defaultScrollTarget(){return this},get _virtualRowCount(){return _Mathceil(this._virtualCount/this._itemsPerRow)},get _estRowsInView(){return _Mathceil(this._viewportHeight/this._rowHeight)},get _physicalRows(){return _Mathceil(this._physicalCount/this._itemsPerRow)},attached:function attached(){this.updateViewportBoundaries();this._render();this.listen(this,"iron-resize","_resizeHandler")},detached:function detached(){this._itemsRendered=!1;this.unlisten(this,"iron-resize","_resizeHandler")},updateViewportBoundaries:function updateViewportBoundaries(){this._scrollerPaddingTop=this.scrollTarget===this?0:parseInt(window.getComputedStyle(this)["padding-top"]||0,10);this._viewportHeight=this._scrollTargetHeight},_update:function _update(itemSet,movingUp){this._assignModels(itemSet);this._updateMetrics(itemSet);if(movingUp){while(movingUp.length){var idx=movingUp.pop();this._physicalTop-=this._getPhysicalSizeIncrement(idx)}}this._positionItems();this._updateScrollerSize();this._increasePoolIfNeeded()},_increasePoolIfNeeded:function _increasePoolIfNeeded(){if(0===this._viewportHeight){return!1}var estPhysicalSize=this._physicalSizes.reduce(function(prev,curr){return prev+(curr||100)},0),isClientHeightFull=estPhysicalSize>this._viewportHeight;if(estPhysicalSize>=this._optPhysicalSize&&isClientHeightFull){return!1}var currentPage=_Mathfloor(this._physicalSize/this._viewportHeight);if(0===currentPage){this._debounceTemplate(this._increasePool.bind(this,_Mathround(.5*this._physicalCount)))}else if(this._lastPage!==currentPage&&isClientHeightFull){Polymer.dom.addDebouncer(this.debounce("_debounceTemplate",this._increasePool.bind(this,this._itemsPerRow),16))}else{var itemHeight=this._physicalSize/this._physicalCount,itemsPerPage=this._viewportHeight/itemHeight,totalNeededItems=this._maxPages*itemsPerPage,missingItems=_Mathceil(totalNeededItems-this._physicalCount);this._debounceTemplate(this._increasePool.bind(this,missingItems||1))}this._lastPage=currentPage;return!0},_debounceTemplate:function _debounceTemplate(fn){Polymer.dom.addDebouncer(this.debounce("_debounceTemplate",fn))},_increasePool:function _increasePool(missingItems){var nextPhysicalCount=_Mathmin(this._physicalCount+missingItems,this._virtualCount-this._virtualStart,_Mathmax(this.maxPhysicalCount,25)),prevPhysicalCount=this._physicalCount,delta=nextPhysicalCount-prevPhysicalCount;if(0>=delta){return}[].push.apply(this._physicalItems,this._createPool(delta));[].push.apply(this._physicalSizes,Array(delta));this._physicalCount=prevPhysicalCount+delta;this._update()},_render:function _render(){var requiresUpdate=0<this._virtualCount||0<this._physicalCount;if(this.isAttached&&!this._itemsRendered&&this._isVisible&&requiresUpdate){this._lastPage=0;this._update();this._itemsRendered=!0}},_iterateItems:function _iterateItems(fn,itemSet){var pidx,vidx,rtn,i;if(2===arguments.length&&itemSet){for(i=0;i<itemSet.length;i++){pidx=itemSet[i];vidx=this._computeVidx(pidx);if(null!=(rtn=fn.call(this,pidx,vidx))){return rtn}}}else{pidx=this._physicalStart;vidx=this._virtualStart;for(;pidx<this._physicalCount;pidx++,vidx++){if(null!=(rtn=fn.call(this,pidx,vidx))){return rtn}}for(pidx=0;pidx<this._physicalStart;pidx++,vidx++){if(null!=(rtn=fn.call(this,pidx,vidx))){return rtn}}}},_computeVidx:function _computeVidx(pidx){if(pidx>=this._physicalStart){return this._virtualStart+(pidx-this._physicalStart)}return this._virtualStart+(this._physicalCount-this._physicalStart)+pidx},_updateMetrics:function _updateMetrics(itemSet){if(this.scrolling){Polymer.dom.flush()}var newPhysicalSize=0,oldPhysicalSize=0,prevAvgCount=this._physicalAverageCount,prevPhysicalAvg=this._physicalAverage;this._iterateItems(function(pidx){oldPhysicalSize+=this._physicalSizes[pidx]||0;this._physicalSizes[pidx]=this._physicalItems[pidx].offsetHeight;newPhysicalSize+=this._physicalSizes[pidx];this._physicalAverageCount+=this._physicalSizes[pidx]?1:0},itemSet);this._viewportHeight=this._scrollTargetHeight;this._physicalSize=this._physicalSize+newPhysicalSize-oldPhysicalSize;if(this._physicalAverageCount!==prevAvgCount){this._physicalAverage=_Mathround((prevPhysicalAvg*prevAvgCount+newPhysicalSize)/this._physicalAverageCount)}},_positionItems:function _positionItems(){this._adjustScrollPosition();var y=this._physicalTop;this._iterateItems(function(pidx){this._physicalItems[pidx].style.transform=this._getTranslate(0,y);y+=this._physicalSizes[pidx]})},_getPhysicalSizeIncrement:function _getPhysicalSizeIncrement(pidx){return this._physicalSizes[pidx]},_shouldRenderNextRow:function _shouldRenderNextRow(vidx){return vidx%this._itemsPerRow===this._itemsPerRow-1},_adjustScrollPosition:function _adjustScrollPosition(){var deltaHeight=0===this._virtualStart?this._physicalTop:_Mathmin(this._scrollPosition+this._physicalTop,0);if(deltaHeight){this._physicalTop=this._physicalTop-deltaHeight;if(!IOS_TOUCH_SCROLLING&&0!==this._physicalTop){this._resetScrollPosition(this._scrollTop-deltaHeight)}}},_resetScrollPosition:function _resetScrollPosition(pos){if(this.scrollTarget){this._scrollTop=pos;this._scrollPosition=this._scrollTop}},_updateScrollerSize:function _updateScrollerSize(forceUpdate){this._estScrollHeight=this._physicalBottom+_Mathmax(this._virtualCount-this._physicalCount-this._virtualStart,0)*this._physicalAverage;forceUpdate=forceUpdate||0===this._scrollHeight;forceUpdate=forceUpdate||this._scrollPosition>=this._estScrollHeight-this._physicalSize;if(forceUpdate||_Mathabs(this._estScrollHeight-this._scrollHeight)>=this._optPhysicalSize){this.$.items.style.height=this._estScrollHeight+"px";this._scrollHeight=this._estScrollHeight}},scrollToIndex:function scrollToIndex(idx){Polymer.dom.flush();idx=_Mathmin(_Mathmax(idx,0),this._virtualCount-1);if(!this._isIndexRendered(idx)||idx>=this._maxVirtualStart){this._virtualStart=idx-1}this._assignModels();this._updateMetrics();var estPhysicalTop=_Mathfloor(this._virtualStart/this._itemsPerRow)*this._physicalAverage;this._physicalTop=estPhysicalTop;var currentTopItem=this._physicalStart,currentVirtualItem=this._virtualStart,targetOffsetTop=0,hiddenContentSize=this._hiddenContentSize;while(currentVirtualItem<idx&&targetOffsetTop<=hiddenContentSize){targetOffsetTop=targetOffsetTop+this._getPhysicalSizeIncrement(currentTopItem);currentTopItem=(currentTopItem+1)%this._physicalCount;currentVirtualItem++}this._updateScrollerSize(!0);this._positionItems();this._resetScrollPosition(this._physicalTop+this._scrollerPaddingTop+targetOffsetTop);this._increasePoolIfNeeded();this._firstVisibleIndexVal=null;this._lastVisibleIndexVal=null},_resetAverage:function _resetAverage(){this._physicalAverage=0;this._physicalAverageCount=0},_resizeHandler:function _resizeHandler(){if(IOS&&100>_Mathabs(this._viewportHeight-this._scrollTargetHeight)){}Polymer.dom.addDebouncer(this.debounce("_debounceTemplate",function(){this.updateViewportBoundaries();this._render();if(this._itemsRendered&&this._physicalItems&&this._isVisible){this._resetAverage();this.scrollToIndex(this.firstVisibleIndex)}}.bind(this),1))},updateSizeForItem:function updateSizeForItem(index){var pidx=this._physicalIndexForKey[index];if(null!=pidx){this._updateMetrics([pidx]);this._positionItems()}},_isIndexRendered:function _isIndexRendered(idx){return idx>=this._virtualStart&&idx<=this._virtualEnd},_isIndexVisible:function _isIndexVisible(idx){return idx>=this.firstVisibleIndex&&idx<=this.lastVisibleIndex}}}();vaadin.elements.grid.IronListBehavior=[Polymer.Templatizer,Polymer.IronScrollTargetBehavior,vaadin.elements.grid.IronListBehaviorImpl];</script><link rel="prefetch" href="../polymer/polymer-mini.html"><link rel="prefetch" href="../polymer/polymer-micro.html"></head><body></body></html>