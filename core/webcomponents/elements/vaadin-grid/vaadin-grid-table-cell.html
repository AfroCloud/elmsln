<html><head><link rel="import" href="../polymer/polymer.html"><link rel="import" href="vaadin-grid-cell-click-behavior.html"><link rel="prefetch" href="../polymer/polymer-mini.html"><link rel="prefetch" href="../polymer/polymer-micro.html"></head><body><dom-module id="vaadin-grid-table-cell"></dom-module><dom-module id="vaadin-grid-table-header-cell"></dom-module><dom-module id="vaadin-grid-table-footer-cell"></dom-module><dom-module id="vaadin-grid-sizer-cell"></dom-module><script>(function(){var vaadinGridTableCellBehavior={properties:{column:Object,expanded:Boolean,flexGrow:Number,colSpan:Number,focused:{type:Boolean,reflectToAttribute:!0},frozen:{type:Boolean,reflectToAttribute:!0},lastFrozen:{type:Boolean,reflectToAttribute:!0},hidden:{type:Boolean,reflectToAttribute:!0},instance:Object,index:Number,item:Object,selected:Boolean,template:Object,target:Object,width:String,order:Number,reorderStatus:{type:String,reflectToAttribute:!0},_childColumns:Array,_cellContent:Object,_insertionPoint:Object,_templatizer:Object},observers:["_columnChanged(column)","_cellAttached(column, isAttached)","_expandedChanged(expanded, instance)","_flexGrowChanged(flexGrow)","_indexChanged(index, instance)","_itemChanged(item, instance)","_instanceChanged(instance, target)","_selectedChanged(selected, instance)","_toggleContent(isAttached, _cellContent, _insertionPoint)","_toggleInstance(isAttached, _templatizer, instance)","_widthChanged(width)","_orderChanged(order)","_visibleChildColumnsChanged(_visibleChildColumns)","_childColumnsChanged(_childColumns)"],ready:function ready(){this.classList.add("vaadin-grid-cell");if(!1===Polymer.Settings.useShadow){this.classList.add("style-scope");this.classList.add("vaadin-grid")}},_columnChanged:function _columnChanged(column){this.flexGrow=column.flexGrow;this.frozen=column.frozen;this.lastFrozen=column._lastFrozen;this.headerTemplate=column.headerTemplate;this.footerTemplate=column.footerTemplate;this.template=column.template;this.width=column.width;this.hidden=column.hidden;this.resizable=column.resizable;this._childColumns=column._childColumns;this.order=column._order;if(column.colSpan){this.colSpan=column.colSpan}this.listen(column,"property-changed","_columnPropChanged")},_cellAttached:function _cellAttached(column,isAttached){if(column===void 0||isAttached===void 0){return}if(isAttached){this.listen(column,"property-changed","_columnPropChanged")}else{this.async(function(){if(!this.isAttached){this.unlisten(column,"property-changed","_columnPropChanged")}})}},_columnPropChanged:function _columnPropChanged(e){if(e.target==this.column){this[e.detail.path]=e.detail.value}},_expandedChanged:function _expandedChanged(expanded,instance){if(expanded===void 0||instance===void 0){return}instance.__expanded__=expanded;instance.expanded=expanded},_flexGrowChanged:function _flexGrowChanged(flexGrow){this.style.flexGrow=flexGrow},_indexChanged:function _indexChanged(index,instance){if(index===void 0||instance===void 0){return}instance.index=index},_itemChanged:function _itemChanged(item,instance){if(item===void 0||instance===void 0){return}instance.item=item},_selectedChanged:function _selectedChanged(selected,instance){if(selected===void 0||instance===void 0){return}instance.__selected__=selected;instance.selected=selected},_childColumnsChanged:function _childColumnsChanged(childColumns){this.colSpan=childColumns.length},_toggleContent:function _toggleContent(isAttached,cellContent,insertionPoint){if(isAttached===void 0||cellContent===void 0||insertionPoint===void 0){return}if(isAttached){if(Polymer.dom(cellContent).parentNode!==this.target){Polymer.dom(this.target).appendChild(cellContent)}Polymer.dom(this).appendChild(insertionPoint)}else{this.async(function(){if(!this.isAttached&&Polymer.dom(cellContent).parentNode===this.target){Polymer.dom(this.target).removeChild(cellContent)}})}},_toggleInstance:function _toggleInstance(isAttached,templatizer,instance){if(isAttached===void 0||templatizer===void 0||instance===void 0){return}if(isAttached){templatizer.addInstance(instance)}else{templatizer.removeInstance(instance)}},_widthChanged:function _widthChanged(width){this.style.width=width},_orderChanged:function _orderChanged(order){this.style.order=order},_templateChanged:function _templateChanged(template){this.instance=template.templatizer.createInstance();this._templatizer=template.templatizer},_instanceChanged:function _instanceChanged(instance,target){if(instance===void 0||target===void 0){return}this.style.height="";this._cellContent=this._cellContent||document.createElement("vaadin-grid-cell-content");var contentId=vaadin.elements.grid._contentIndex=vaadin.elements.grid._contentIndex+1||0,id="vaadin-grid-cell-content-"+contentId;this._cellContent.innerHTML="";Polymer.dom(this._cellContent).appendChild(this.instance.root);this._cellContent.setAttribute("id",id);if(Polymer.Element){this._cellContent.setAttribute("slot",id);this._insertionPoint=this._insertionPoint||document.createElement("slot");this._insertionPoint.setAttribute("name",id)}else{this._insertionPoint=this._insertionPoint||document.createElement("content");this._insertionPoint.setAttribute("select","#"+id)}}};Polymer({is:"vaadin-grid-table-cell",behaviors:[vaadinGridTableCellBehavior,vaadin.elements.grid.CellClickBehavior],observers:["_templateChanged(template)"],_cellClick:function _cellClick(e){if(!e.defaultPrevented){this.fire("cell-activate",{model:this.instance})}}});Polymer({is:"vaadin-grid-table-header-cell",properties:{headerTemplate:Object,resizable:Boolean,columnResizing:{type:Boolean,reflectToAttribute:!0}},behaviors:[vaadinGridTableCellBehavior,vaadin.elements.grid.CellClickBehavior],observers:["_headerTemplateChanged(headerTemplate)","_isEmptyChanged(_isEmpty, isAttached)","_resizableChanged(resizable)"],listeners:{mousedown:"_cancelMouseDownOnResize",mousemove:"_enableDrag",mouseout:"_disableDrag",touchstart:"_onTouchStart",touchmove:"_onTouchMove",touchend:"_onTouchEnd",contextmenu:"_onContextMenu"},_onContextMenu:function _onContextMenu(e){if(this._reorderGhost){e.preventDefault()}},_onTouchStart:function _onTouchStart(e){if(e.target!==this._resizeHandle&&this.target.columnReorderingAllowed){this._startReorderTimeout=setTimeout(this._startReorder.bind(this,e),100)}},_startReorder:function _startReorder(e){this._reorderGhost=this._getGhost();this._reorderGhost.style.visibility="visible";var dragStart=new CustomEvent("dragstart",{bubbles:!0});this._cellContent.dispatchEvent(dragStart);this._reorderXY={x:e.touches[0].clientX-this.getBoundingClientRect().left,y:e.touches[0].clientY-this.getBoundingClientRect().top};this._updateGhostPosition(e.touches[0].clientX,e.touches[0].clientY)},_onTouchMove:function _onTouchMove(e){if(this._reorderGhost){e.preventDefault();var dragOver=new CustomEvent("dragover",{bubbles:!0});dragOver.clientX=e.touches[0].clientX;dragOver.clientY=e.touches[0].clientY;var target=this._contentFromPoint(dragOver.clientX,dragOver.clientY);if(target){target.dispatchEvent(dragOver)}this._updateGhostPosition(e.touches[0].clientX,e.touches[0].clientY)}else{clearTimeout(this._startReorderTimeout)}},_updateGhostPosition:function _updateGhostPosition(eventClientX,eventClientY){var targetLeft=eventClientX-this._reorderXY.x,targetTop=eventClientY-this._reorderXY.y-50,_left=parseInt(this._reorderGhost.style.left||0),_top=parseInt(this._reorderGhost.style.top||0),ghostRect=this._reorderGhost.getBoundingClientRect();this._reorderGhost.style.left=_left-(ghostRect.left-targetLeft)+"px";this._reorderGhost.style.top=_top-(ghostRect.top-targetTop)+"px"},_onTouchEnd:function _onTouchEnd(e){clearTimeout(this._startReorderTimeout);if(this._reorderGhost){e.preventDefault();var event=new CustomEvent("dragend",{bubbles:!0});this.dispatchEvent(event);this._reorderGhost.style.visibility="hidden";this._reorderGhost=null}},_contentFromPoint:function _contentFromPoint(x,y){if(Polymer.Settings.useShadow){var scroller=this.target.$.scroller;scroller.toggleAttribute("no-content-pointer-events",!0);var cell=this.domHost.root.elementFromPoint(x,y);scroller.toggleAttribute("no-content-pointer-events",!1);if(cell&&cell.getContentChildren){return cell.getContentChildren(Polymer.Element?"slot":"content")[0]}}else{return document.elementFromPoint(x,y)}},_getGhost:function _getGhost(){var ghost=this.target.$.scroller.$.reorderghost;ghost.innerText=this._cellContent.innerText;var style=window.getComputedStyle(this._cellContent);["boxSizing","display","width","height","background","alignItems","padding","border","flex-direction","overflow"].forEach(function(propertyName){ghost.style[propertyName]=style[propertyName]},this);return ghost},_enableDrag:function _enableDrag(){this._cellContent.draggable=this.target.columnReorderingAllowed&&!window.getSelection().toString()},_disableDrag:function _disableDrag(){this._cellContent.draggable=!1},_cancelMouseDownOnResize:function _cancelMouseDownOnResize(e){if(e.target===this._resizeHandle){e.preventDefault()}},_resizableChanged:function _resizableChanged(resizable){if(resizable){this._resizeHandle=document.createElement("div");this._resizeHandle.classList.add("vaadin-grid-column-resize-handle");this.listen(this._resizeHandle,"track","_onTrack");Polymer.dom(this).appendChild(this._resizeHandle)}else if(this._resizeHandle){this.unlisten(this._resizeHandle,"track","_onTrack");Polymer.dom(this).removeChild(this._resizeHandle)}},_onTrack:function _onTrack(e){this.columnResizing=!0;var column=this.column;if("vaadin-grid-column-group"===column.localName){column=Array.prototype.slice.call(column._childColumns,0).sort(function(a,b){return a._order-b._order}).filter(function(column){return!column.hidden}).pop()}var targetCell=this._getHeaderCellByColumn(column);if(targetCell.offsetWidth){var style=window.getComputedStyle(targetCell._cellContent),minWidth=10+parseInt(style.paddingLeft)+parseInt(style.paddingRight);column.width=Math.max(minWidth,targetCell.offsetWidth+e.detail.x-targetCell.getBoundingClientRect().right)+"px";column.flexGrow=0}var header=this.parentElement.parentElement;Array.prototype.slice.call(Polymer.dom(header).querySelectorAll(".vaadin-grid-row:last-child .vaadin-grid-cell")).sort(function(a,b){return a.column._order-b.column._order}).forEach(function(cell,index,array){if(index<array.indexOf(targetCell)){cell.column.width=cell.offsetWidth+"px";cell.column.flexGrow=0}});if(this.columnResizing&&"end"===e.detail.state){this.columnResizing=!1}this.fire("column-resizing")},_getHeaderCellByColumn:function _getHeaderCellByColumn(column){var header=this.parentElement.parentElement;return Array.prototype.filter.call(Polymer.dom(header).querySelectorAll(".vaadin-grid-row:last-child .vaadin-grid-cell"),function(cell){return cell.column===column})[0]},_headerTemplateChanged:function _headerTemplateChanged(headerTemplate){if(headerTemplate===void 0){return}if(null!==headerTemplate&&(this._isColumnRow||"vaadin-grid-column-group"===this.column.localName)){this.instance=headerTemplate.templatizer.createInstance();this._templatizer=headerTemplate.templatizer;this._isEmpty=!1}else{this.instance={root:document.createElement("div")};this._isEmpty=!0}},_isEmptyChanged:function _isEmptyChanged(isEmpty,isAttached){if(isAttached){this.fire("cell-empty-changed")}}});Polymer({is:"vaadin-grid-table-footer-cell",properties:{footerTemplate:Object},behaviors:[vaadinGridTableCellBehavior,vaadin.elements.grid.CellClickBehavior],observers:["_footerTemplateChanged(footerTemplate)","_isEmptyChanged(_isEmpty, isAttached)"],_footerTemplateChanged:function _footerTemplateChanged(footerTemplate){if(footerTemplate===void 0){return}if(null!==footerTemplate&&(this._isColumnRow||"vaadin-grid-column-group"===this.column.localName)){this.instance=footerTemplate.templatizer.createInstance();this._templatizer=footerTemplate.templatizer;this._isEmpty=!1}else{this.instance={root:document.createElement("div")};this._isEmpty=!0}},_isEmptyChanged:function _isEmptyChanged(isEmpty,isAttached){if(isAttached){this.fire("cell-empty-changed")}}});Polymer({is:"vaadin-grid-sizer-cell",behaviors:[vaadinGridTableCellBehavior]})})();</script></body></html>