<html><head><link rel="import" href="../../polymer/polymer.html"><link rel="import" href="../../iron-a11y-keys/iron-a11y-keys.html"><link rel="import" href="../../paper-icon-button/paper-icon-button.html"><link rel="import" href="../mtz-marked-control-line-behavior.html"><link rel="prefetch" href="../../polymer/polymer-mini.html"><link rel="prefetch" href="../../polymer/polymer-micro.html"><link rel="prefetch" href="../../iron-a11y-keys-behavior/iron-a11y-keys-behavior.html"><link rel="prefetch" href="../../iron-icon/iron-icon.html"><link rel="prefetch" href="../../iron-meta/iron-meta.html"><link rel="prefetch" href="../../iron-flex-layout/iron-flex-layout.html"><link rel="prefetch" href="../../paper-behaviors/paper-inky-focus-behavior.html"><link rel="prefetch" href="../../iron-behaviors/iron-button-state.html"><link rel="prefetch" href="../../iron-behaviors/iron-control-state.html"><link rel="prefetch" href="../../paper-behaviors/paper-ripple-behavior.html"><link rel="prefetch" href="../../paper-ripple/paper-ripple.html"><link rel="prefetch" href="../../paper-styles/default-theme.html"><link rel="prefetch" href="../../paper-styles/color.html"><link rel="prefetch" href="../mtz-marked-control-behavior.html"></head><body><dom-module id="mtz-marked-control-link"><template><style>:host{display:inline-block;}</style><paper-icon-button icon="[[icon]]" noink="[[noink]]" on-click="_handleCommand" alt="[[title]]"></paper-icon-button><iron-a11y-keys keys="[[keys]]" on-keys-pressed="_handleCommand" target="[[__editor]]"></iron-a11y-keys></template><script>Polymer({is:"mtz-marked-control-link",behaviors:[mtz.MarkedControlBehavior],properties:{title:String,icon:String,keys:String,noink:Boolean},_handleCommand:function _handleCommand(event){event.preventDefault();event.stopPropagation();var editor=this.__editor,selection=editor.getSelection(),regex=/\[(.*)\]\((.*)\)/,matches=selection.text.match(regex),text,link;if(matches){text=matches[1];link=matches[2];var match=link||text;editor.replaceSelection(match);editor.setSelection(selection.start,selection.end-(selection.length-match.length))}else{if(this._isLink(selection)){text=prompt("What text would you like to display?");if(!text)return;link=selection.text}else{link=prompt("What link would you like to use?");if(!link)return;text=selection.text}if(link.startsWith("http://")){alert("Links must be https://");return}var newLink=regex[Symbol.replace]("[]()","[".concat(text,"](").concat(link,")"));editor.replaceSelection(newLink);editor.setSelection(selection.start,selection.end+(newLink.length-selection.length))}},_isLink:function _isLink(selection){return selection.text.startsWith("https://")}});</script></dom-module></body></html>