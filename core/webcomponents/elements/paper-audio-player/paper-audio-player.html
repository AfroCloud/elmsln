<html><head><link href="https://fonts.googleapis.com/css?family=Roboto+Mono" rel="stylesheet" type="text/css"><link rel="import" href="../polymer/polymer.html"><link rel="import" href="../paper-progress/paper-progress.html"><link rel="import" href="../iron-icon/iron-icon.html"><link rel="import" href="../paper-icon-button/paper-icon-button.html"><link rel="import" href="../paper-ripple/paper-ripple.html"><link rel="import" href="../iron-a11y-keys-behavior/iron-a11y-keys-behavior.html"><link rel="import" href="paper-audio-icons.html"><link rel="prefetch" href="../polymer/polymer-mini.html"><link rel="prefetch" href="../polymer/polymer-micro.html"><link rel="prefetch" href="../iron-flex-layout/iron-flex-layout.html"><link rel="prefetch" href="../iron-range-behavior/iron-range-behavior.html"><link rel="prefetch" href="../paper-styles/color.html"><link rel="prefetch" href="../iron-meta/iron-meta.html"><link rel="prefetch" href="../paper-behaviors/paper-inky-focus-behavior.html"><link rel="prefetch" href="../iron-behaviors/iron-button-state.html"><link rel="prefetch" href="../iron-behaviors/iron-control-state.html"><link rel="prefetch" href="../paper-behaviors/paper-ripple-behavior.html"><link rel="prefetch" href="../paper-styles/default-theme.html"><link rel="prefetch" href="../iron-iconset-svg/iron-iconset-svg.html"></head><body><dom-module id="paper-audio-player"><template><style>:host{display:block;box-sizing:border-box;font-family:'Roboto Mono', 'Helvetica Neue', Arial, sans-serif;}#wrapper{position:relative;cursor:pointer;height:50px;box-shadow:0 1px 2px rgba(0,0,0,.3);}#left,
      #right{height:50px;width:50px;position:relative;}#left{background-color:var(--paper-audio-player-color, blueviolet);}#right{background-color:rgba(255,255,255,.75);}paper-icon-button,
      iron-icon{color:#fff;}#duration,
      #title,
      #progress2{text-align:center;line-height:50px;}#duration{font-size:11px;color:var(--paper-audio-player-color, blueviolet);}paper-icon-button,
      iron-icon{margin:auto;}#replay{opacity:0;color:var(--paper-audio-player-color, blueviolet);}#title,
      #progress2{pointer-events:none;font-size:15px;}#title{z-index:2;color:var(--paper-audio-player-color, blueviolet);}#progress2{width:0px;z-index:5;color:#fff;overflow:hidden;}#center{position:relative;overflow:hidden;background-color:rgba(255,255,255,.75);}#progress{width:100%;transform-origin:left;transform:scaleX(0);background-color:var(--paper-audio-player-color, blueviolet);}paper-ripple{color:var(--paper-audio-player-color, blueviolet);}:host:not(.cantplay) #right:hover #replay{opacity:1;}#right:hover #duration{opacity:0;}#left:hover #play,
      #left:hover #pause{transform:scale3d(1.1, 1.1, 1.1);-ms-transform:scale3d(1.1, 1.1, 1.1);-webkit-transform:scale3d(1.1, 1.1, 1.1);}:host(.cantplay) #title{font-size:12px;}:host(.cantplay) #wrapper{cursor:default;}:host(.cantplay) #play{opacity:0;}.layout-horizontal{display:flex;display:-webkit-flex;display:-ms-flexbox;-ms-flex-direction:row;-webkit-flex-direction:row;flex-direction:row;}.flex{-ms-flex:1;-webkit-flex:1;flex:1;}.fit{position:absolute;top:0;right:0;bottom:0;left:0;}.self-start{-ms-align-self:flex-start;-webkit-align-self:flex-start;align-self:flex-start;}.self-end{-ms-align-self:flex-end;-webkit-align-self:flex-end;align-self:flex-end;}</style><div id="wrapper" class="layout-horizontal"><div id="left" class="self-start" on-tap="playPause"><paper-icon-button id="play" icon="paper-audio-icons:play-arrow" class="fit" hidden$="{{ _hidePlayIcon(isPlaying, canBePlayed) }}" role="button" aria-label="Play Audio" tabindex="-1"></paper-icon-button><paper-icon-button id="pause" icon="paper-audio-icons:pause" class="fit" hidden$="{{ !isPlaying }}" role="button" aria-label="Pause Audio" tabindex="-1"></paper-icon-button><iron-icon id="error" icon="paper-audio-icons:error-outline" class="fit" hidden$="{{ !error }}"></iron-icon></div><div id="center" class="flex" on-down="_onDown"><div id="title" class="fit" role="alert">{{ title }}</div><audio id="audio" src="{{ src }}" preload="{{ _setPreload(autoPlay, preload) }}"></audio><div id="progress" class="fit"></div><paper-ripple></paper-ripple><div id="progress2" class="fit"><div id="title2" aria-hidden="true">{{ title }}</div></div></div><div id="right" class="self-end" on-click="restart"><div id="duration" class="fit" hidden$="{{ ended }}"><span class="fit" role="timer" aria-label="Audio Track Length">{{ _convertSecToMin(timeLeft) }}</span></div><paper-icon-button id="replay" class="fit" icon="paper-audio-icons:replay" tabindex="-1" role="button" aria-label="Replay Audio"></paper-icon-button></div></div></template><script>Polymer({is:'paper-audio-player',behaviors:[Polymer.IronA11yKeysBehavior],hostAttributes:{tabindex:0,role:'application',"aria-label":'Audio Player',"aria-describedby":'title'},properties:{src:{type:String,observer:'_srcChanged'},title:{type:String,value:'Click to play this audio file'},color:{type:String,observer:'_changeColor'},autoPlay:{type:Boolean,value:!1},preload:{type:String,value:'auto'},currentTime:{type:Number,value:0,notify:!0},timeLeft:{type:Number,value:0},smallSkip:{type:Number,value:15},largeSkip:{type:Number,value:60},error:{type:Boolean},timeOffset:{type:Number,value:0}},listeners:{"audio.loadedmetadata":'_onCanPlay',"audio.playing":'_onPlaying',"audio.pause":'_onPause',"audio.ended":'_onEnd',"audio.error":'_onError'},keyBindings:{space:'playPause',enter:'playPause',left:'_skipReverseByInterval',right:'_skipReverseByInterval',down:'_skipReverseByInterval',up:'_skipReverseByInterval'},ready:function(){var a=this;a.canBePlayed=!1,a.isPlaying=!1,a.ended=!1,a.error=!1,a.$.audio.currentTime=a.timeOffset},playPause:function(a){!a||a.preventDefault();var b=this;return b.canBePlayed?b.isPlaying?b.$.audio.pause():b.$.audio.play():void('none'===b.preload&&(b.$.audio.load(),b.$.audio.play()))},restart:function(a){!a||a.preventDefault();var b=this;b.$.audio.currentTime=0,b.isPlaying||b.$.audio.play()},_onCanPlay:function(){var a=this;if(a.canBePlayed=!0,a.timeLeft=a.$.audio.duration,0<a.timeOffset){var b=a.timeOffset/a.$.audio.duration;a._updateVisualProgress(b)}a.autoPlay&&a.$.audio.play()},_onPlaying:function(){var a=this;a.ended=!1,a.isPlaying=!0,a.$.replay.style='',a._startProgressTimer()},_skipReverseByInterval:function(a){!a||a.preventDefault();var b=this,c=0;switch(a.detail.key){case'up':b.largeSkip<b.timeLeft&&(c=b.currentTime+b.largeSkip);break;case'down':0<b.currentTime-b.largeSkip&&(c=b.currentTime-b.largeSkip);break;case'right':b.smallSkip<b.timeLeft&&(c=b.currentTime+b.smallSkip);break;default:0<b.currentTime-b.smallSkip&&(c=b.currentTime-b.smallSkip);}b._updatePlayPosition(c),b.isPlaying||b.$.audio.play()},_startProgressTimer:function(){var a=this;a.timer={},a.timer.sliderUpdateInterval&&clearInterval(a.timer.sliderUpdateInterval),a.timer.sliderUpdateInterval=setInterval(function(){if(a.isPlaying){a.currentTime=a.$.audio.currentTime,a.timeLeft=a.$.audio.duration-a.currentTime;var b=a.currentTime/a.$.audio.duration;a._updateVisualProgress(b)}else clearInterval(a.timer.sliderUpdateInterval)},60)},_onPause:function(){var a=this;a.isPlaying=!1},_onEnd:function(){var a=this;a.ended=!0,a.isPlaying=!1,a.$.replay.style.opacity=1},_onError:function(){var a=this;a.classList.add('cantplay'),a.title='Sorry, can\'t play track: '+a.title,a.error=!0,a.setAttribute('aria-invalid','true')},_convertSecToMin:function(a){var b=Math.floor;if(0===a)return'';var c=b(a/60),d=b(a%60)+'';return c+':'+(2>d.length?'0'+d:d)},_onDown:function(a){a.preventDefault();var b=this;b.canBePlayed?(b._updateProgressBar(a),!b.isPlaying&&b.$.audio.play()):'none'===b.preload&&(b.$.audio.load(),b.$.audio.addEventListener('loadedmetadata',function(){b._updateProgressBar(a),b.isPlaying||b.$.audio.play()},!1))},_updateProgressBar:function(a){var b=this,c=a.detail.x-b.$.center.getBoundingClientRect().left,d=c/b.$.center.getBoundingClientRect().width*b.$.audio.duration;this._updatePlayPosition(d)},_updatePlayPosition:function(a){var b=this;b.currentTime=b.$.audio.currentTime=a;var c=b.currentTime/b.$.audio.duration;b._updateVisualProgress(c)},_updateVisualProgress:function(a){var b=this;b.$.progress.style.transform='scaleX('+a+')',b.$.progress2.style.width=100*a+'%',b.$.title2.style.width=100*(1/a)+'%'},_srcChanged:function(){var a=this;a.isPlaying&&(a.$.audio.pause(),a.$.audio.play())},_changeColor:function(a){var b=this;b.$.left.style.backgroundColor=a,b.$.title.style.color=a,b.$.duration.style.color=a,b.$.progress.style.backgroundColor=a,b.$.replay.style.color=a},_hidePlayIcon:function(a,b){return!!a||!(b||'none'===this.preload)},_setPreload:function(a,b){return a?'auto':b}});</script></dom-module></body></html>