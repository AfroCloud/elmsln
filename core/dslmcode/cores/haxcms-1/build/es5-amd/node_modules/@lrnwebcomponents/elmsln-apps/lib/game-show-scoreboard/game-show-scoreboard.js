define(["exports","../../../../@polymer/polymer/polymer-element.js","../../../../@polymer/polymer/lib/elements/dom-if.js","../../../../@polymer/polymer/lib/elements/dom-repeat.js","../../../../@polymer/app-route/app-location.js","../../../../@polymer/app-route/app-route.js","../../../../@polymer/iron-ajax/iron-ajax.js","../../../../@polymer/paper-toggle-button/paper-toggle-button.js","../../../../@polymer/paper-item/paper-item.js","../../../../@polymer/paper-button/paper-button.js","../../../../@polymer/paper-input/paper-input.js","../../../../@polymer/paper-icon-button/paper-icon-button.js","../../../../@polymer/paper-tooltip/paper-tooltip.js","../../../../@vaadin/vaadin-grid/vaadin-grid.js","../../../../@vaadin/vaadin-grid/vaadin-grid-filter.js","../../../../@vaadin/vaadin-grid/vaadin-grid-sorter.js","../../../../@vaadin/vaadin-grid/vaadin-grid-sort-column.js","../../../../@vaadin/vaadin-grid/vaadin-grid-column-group.js","../../../../@vaadin/vaadin-grid/vaadin-grid-selection-column.js","../../../simple-datetime/simple-datetime.js","../../../elmsln-loading/elmsln-loading.js","../../../simple-picker/simple-picker.js","../../../lrndesign-avatar/lrndesign-avatar.js"],function(_exports,_polymerElement,_domIf,_domRepeat,_appLocation,_appRoute,_ironAjax,_paperToggleButton,_paperItem,_paperButton,_paperInput,_paperIconButton,_paperTooltip,_vaadinGrid,_vaadinGridFilter,_vaadinGridSorter,_vaadinGridSortColumn,_vaadinGridColumnGroup,_vaadinGridSelectionColumn,_simpleDatetime,_elmslnLoading,_simplePicker,_lrndesignAvatar){"use strict";Object.defineProperty(_exports,"__esModule",{value:!0});_exports.GameShowScoreboard=void 0;function _templateObject_8c891490a73511e9bb9973e2853203f5(){var data=babelHelpers.taggedTemplateLiteral(["\n    <style>\n      :host {\n        display: block;\n        align-content: center;\n        padding: .8em;\n      }\n      vaadin-grid-table-body > vaadin-grid-cell-content {\n        height: unset !important;\n      }\n      #loading {\n        width: 100%;\n        z-index: 1000;\n        opacity: .8;\n        text-align: center;\n        align-content: center;\n        justify-content: center;\n        height: 100vh;\n        position: absolute;\n        background-color: white;\n      }\n      vaadin-grid#material {\n        height: 75vh;\n        font-family: Roboto, sans-serif;\n        --divider-color: rgba(0, 0, 0, var(--dark-divider-opacity));\n\n        --vaadin-grid-cell: {\n          padding: 0;\n        };\n\n        --vaadin-grid-header-cell: {\n          height: 3.5em;\n          color: rgba(0, 0, 0, var(--dark-secondary-opacity));\n          font-size: 1em;\n        };\n\n        --vaadin-grid-body-cell: {\n          height: 3em;\n          color: rgba(0, 0, 0, var(--dark-primary-opacity));\n          font-size: .8em;\n        };\n\n        --vaadin-grid-body-row-hover-cell: {\n          background-color: var(--paper-grey-200);\n        };\n\n        --vaadin-grid-body-row-selected-cell: {\n          background-color: var(--paper-grey-100);\n        };\n\n        --vaadin-grid-focused-cell: {\n          box-shadow: none;\n          font-weight: bold;\n        };\n      }\n\n      vaadin-grid#material .cell {\n        overflow: hidden;\n        text-overflow: ellipsis;\n        padding-right: 56px;\n      }\n\n      vaadin-grid#material .cell.last {\n        padding-right: 24px;\n      }\n\n      vaadin-grid#material .cell.numeric {\n        text-align: right;\n      }\n\n      vaadin-grid#material paper-checkbox {\n        --primary-color: var(--paper-indigo-500);\n        margin: 0 24px;\n      }\n\n      vaadin-grid#material vaadin-grid-sorter .cell {\n        flex: 1;\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n      }\n\n      vaadin-grid#material vaadin-grid-sorter iron-icon {\n        transform: scale(0.8);\n      }\n\n      vaadin-grid#material vaadin-grid-sorter:not([direction]) iron-icon {\n        color: rgba(0, 0, 0, var(--dark-disabled-opacity));\n      }\n\n      vaadin-grid#material vaadin-grid-sorter[direction] {\n        color: rgba(0, 0, 0, var(--dark-primary-opacity));\n      }\n\n      vaadin-grid#material vaadin-grid-sorter[direction=desc] iron-icon {\n        transform: scale(0.8) rotate(180deg);\n      }\n      vaadin-grid-sorter {\n        text-align: center;\n      }\n      lrndesign-avatar {\n        display: inline-block;\n      }\n      .avatar-label {\n        display: inline-block;\n        margin-left: .2em;\n      }\n      simple-datetime, .score {\n        margin: 0;\n        padding: 8px;\n        line-height: 14px;\n        font-size: 14px;\n        color: black;\n      }\n    </style>\n    <app-location route=\"{{route}}\"></app-location>\n    <app-route\n        route=\"{{route}}\"\n        pattern=\"[[endPoint]]/submissions/:submission\"\n        data=\"{{data}}\"\n        tail=\"{{tail}}\">\n    </app-route>\n    <iron-ajax auto\n      id=\"optionsrequest\"\n      url=\"[[optionsPath]]\"\n      handle-as=\"json\"\n      last-response=\"{{optionsData}}\"></iron-ajax>\n    <simple-picker id=\"section\" label=\"Section\" value=\"{{section}}\" options=\"[[sectionOptions]]\"></simple-picker>\n    <simple-picker id=\"game\" label=\"Game\" value=\"{{game}}\" options=\"[[gameOptions]]\"></simple-picker>\n    <iron-ajax\n      auto\n      id=\"datarequest\"\n      url=\"[[dataRequestUrl]]\"\n      handle-as=\"json\"\n      last-response=\"{{activeData}}\"></iron-ajax>\n    <vaadin-grid hidden$=\"[[!visibleData]]\" id=\"material\" aria-label=\"Student project list\" items=\"[[_toArray(visibleData)]]\"theme=\"row-dividers\" column-reordering-allowed multi-sort>\n      <vaadin-grid-column resizable>\n        <template class=\"header\">\n          <vaadin-grid-sorter id=\"sorter\" path=\"sis.sortable_name\">Student</vaadin-grid-sorter>\n        </template>\n        <template>\n          <lrndesign-avatar label=\"[[item.name]]\" src=\"[[item.avatar]]\"></lrndesign-avatar>\n          <span class=\"avatar-label\">[[item.sis.sortable_name]]</span>\n        </template>\n        <template class=\"footer\">\n          <vaadin-grid-filter aria-label=\"Student\" path=\"sis.sortable_name\" value=\"[[_filterName]]\">\n            <paper-input slot=\"filter\" label=\"Student\" value=\"{{_filterName::input}}\" focus-target></paper-input>\n          </vaadin-grid-filter>\n        </template>\n      </vaadin-grid-column>\n      <vaadin-grid-column resizable>\n        <template class=\"header\">\n          <vaadin-grid-sorter id=\"sorter\" path=\"name\">Name</vaadin-grid-sorter>\n        </template>\n        <template>\n          [[item.name]]\n        </template>\n        <template class=\"footer\">\n          <vaadin-grid-filter aria-label=\"Student\" path=\"name\" value=\"[[_filterUserName]]\">\n            <paper-input slot=\"filter\" label=\"Username\" value=\"{{_filterUserName::input}}\" focus-target></paper-input>\n          </vaadin-grid-filter>\n        </template>\n      </vaadin-grid-column>\n      <vaadin-grid-sort-column resizable\n          width=\"1em\"\n          header=\"High score\"\n          path=\"high\"\n        >\n        [[item.high]]\n      </vaadin-grid-sort-column>\n      <vaadin-grid-column resizable\n          width=\"1em\"\n          header=\"All Scores\"\n          path=\"scores\"\n        >\n        <template>\n        <dom-repeat items=\"[[item.scores]]\" as=\"score\">\n          <template>\n            <div class=\"score\">[[score]]</div>\n          </template>\n        </dom-repeat>\n        </template>\n      </vaadin-grid-column>\n      <vaadin-grid-column resizable\n          width=\"1em\"\n          header=\"Attempt Dates\"\n          path=\"dates\"\n        >\n        <template>\n        <dom-repeat items=\"[[item.dates]]\" as=\"date\" mutable-data>\n          <template>\n            <simple-datetime\n              format=\"M jS, Y h:i:s\"\n              timestamp=\"[[date]]\"\n              unix\n            ></simple-datetime>\n          </template>\n        </dom-repeat>\n        </template>\n      </vaadin-grid-column>\n    </vaadin-grid>"]);_templateObject_8c891490a73511e9bb9973e2853203f5=function _templateObject_8c891490a73511e9bb9973e2853203f5(){return data};return data}var GameShowScoreboard=/*#__PURE__*/function(_PolymerElement){babelHelpers.inherits(GameShowScoreboard,_PolymerElement);function GameShowScoreboard(){babelHelpers.classCallCheck(this,GameShowScoreboard);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(GameShowScoreboard).apply(this,arguments))}babelHelpers.createClass(GameShowScoreboard,[{key:"_computeDataRequestUrl",value:function _computeDataRequestUrl(dataPath,section,game){return"".concat(dataPath,"?section=").concat(section,"&game=").concat(game)}},{key:"_optionsDataChanged",value:function _optionsDataChanged(newValue){if(newValue&&newValue.status){var sections=[];for(var i in newValue.data.sections){sections.push([{alt:newValue.data.sections[i],value:newValue.data.sections[i]}])}var games=[];for(var i in newValue.data.games){games.push([{alt:newValue.data.games[i],value:newValue.data.games[i]}])}this.set("sectionOptions",sections);this.set("gameOptions",games)}}},{key:"_activeDataChanged",value:function _activeDataChanged(newValue){this.set("visibleData",newValue.data)}/**
   * Route changed
   */},{key:"_routeChanged",value:function _routeChanged(route,endPoint){if("string"===typeof route.path){if("string"===typeof endPoint){// ignore "home page" as well since that's our path
if(route.path.startsWith(endPoint)||"/"==route.path){return}}this.$.loading.hidden=!1;// reload the page which since route changed will load that page
window.location.reload()}}},{key:"_toArray",value:function _toArray(obj){if(null==obj){return[]}return Object.keys(obj).map(function(key){return obj[key]})}}],[{key:"template",get:function get(){return(0,_polymerElement.html)(_templateObject_8c891490a73511e9bb9973e2853203f5())}},{key:"tag",get:function get(){return"game-show-scoreboard"}},{key:"observers",get:function get(){return["_routeChanged(route, endPoint)"]}/**
   * props
   */},{key:"properties",get:function get(){return{elmslnCourse:{type:String},elmslnSection:{type:String},basePath:{type:String},csrfToken:{type:String},endPoint:{type:String},optionsPath:{type:String},dataPath:{type:String},section:{type:String},game:{type:String},dataRequestUrl:{type:String,computed:"_computeDataRequestUrl(dataPath, section, game)"},/**
       * routing variable for url
       */route:{type:String},tail:{type:String},optionsData:{type:Object,value:{},observer:"_optionsDataChanged"},sectionOptions:{type:Array,value:[]},gameOptions:{type:Array,value:[]},activeData:{type:Object,value:{},observer:"_activeDataChanged"},visibleData:{type:Array,value:[]}}}}]);return GameShowScoreboard}(_polymerElement.PolymerElement);_exports.GameShowScoreboard=GameShowScoreboard;window.customElements.define(GameShowScoreboard.tag,GameShowScoreboard)});